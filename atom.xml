<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>shuke&#39;s Blog</title>
  
  <subtitle>技术 管理 生活 格局 人生</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://shuke163.github.io/"/>
  <updated>2020-06-19T16:37:56.692Z</updated>
  <id>https://shuke163.github.io/</id>
  
  <author>
    <name>shuke</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Go语言数据类型</title>
    <link href="https://shuke163.github.io/2020/06/20/Go%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
    <id>https://shuke163.github.io/2020/06/20/Go%E8%AF%AD%E8%A8%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</id>
    <published>2020-06-19T16:07:04.000Z</published>
    <updated>2020-06-19T16:37:56.692Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Go语言数据类型"><a href="#Go语言数据类型" class="headerlink" title="Go语言数据类型"></a>Go语言数据类型</h2><h3 id="1-1-整形与字符串之间的转换"><a href="#1-1-整形与字符串之间的转换" class="headerlink" title="1.1 整形与字符串之间的转换"></a>1.1 整形与字符串之间的转换</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同类型之间可以进行相加</span></span><br><span class="line"><span class="keyword">var</span> v1 <span class="keyword">int8</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> v2 <span class="keyword">int16</span> = <span class="number">8</span></span><br><span class="line">v3 := <span class="keyword">int16</span>(v1) + v2</span><br><span class="line">fmt.Println(v3)</span><br><span class="line">fmt.Println(v3, reflect.TypeOf(v3))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 整形与字符串之间的转换</span></span><br><span class="line">v5 := <span class="number">19</span></span><br><span class="line"><span class="keyword">var</span> v4 <span class="keyword">int</span> = <span class="number">19</span></span><br><span class="line">res := strconv.Itoa(v5)</span><br><span class="line">fmt.Println(v4, reflect.TypeOf(res))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串转换为整形</span></span><br><span class="line">v6 := <span class="string">"shuke"</span></span><br><span class="line">result, err := strconv.Atoi(v6)</span><br><span class="line"><span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"转换成功!"</span>, result)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"转换失败!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-2常见数学运算"><a href="#1-2常见数学运算" class="headerlink" title="1.2常见数学运算"></a>1.2常见数学运算</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"math"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(math.Abs(<span class="number">-10</span>))                 <span class="comment">// 取绝对值</span></span><br><span class="line">fmt.Println(math.Floor(<span class="number">3.14</span>))              <span class="comment">// 向下取整</span></span><br><span class="line">fmt.Println(math.Ceil(<span class="number">3.14</span>))               <span class="comment">// 向下取整</span></span><br><span class="line">fmt.Println(math.Round(<span class="number">3.34789</span>))           <span class="comment">// 就近取整</span></span><br><span class="line">fmt.Println(math.Round(<span class="number">3.34789</span>*<span class="number">100</span>) / <span class="number">100</span>) <span class="comment">// 保留小数点后两位</span></span><br><span class="line">fmt.Println(math.Mod(<span class="number">11</span>, <span class="number">3</span>))               <span class="comment">// 取余数， 同 11 % 3</span></span><br><span class="line">fmt.Println(math.Pow(<span class="number">2</span>, <span class="number">5</span>))                <span class="comment">// 计算次方,如 2 的5次方</span></span><br><span class="line">fmt.Println(math.Pow10(<span class="number">2</span>))                 <span class="comment">// 计算10次方,如 2 的10次方</span></span><br><span class="line">fmt.Println(math.Max(<span class="number">1</span>, <span class="number">2</span>))                <span class="comment">// 两个值， 取较大值</span></span><br><span class="line">fmt.Println(math.Min(<span class="number">1</span>, <span class="number">2</span>))                <span class="comment">// 两个值， 取较小值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3.35</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">32</span></span><br><span class="line"><span class="number">100</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="1-3-指针"><a href="#1-3-指针" class="headerlink" title="1.3 指针"></a>1.3 指针</h3><blockquote><p>  nil 使用new关键字进行变量声明</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明一个变量</span></span><br><span class="line"><span class="keyword">var</span> v1 <span class="keyword">int</span></span><br><span class="line">v1 = <span class="number">99</span></span><br><span class="line">v2 := <span class="number">88</span></span><br><span class="line">fmt.Println(v1, v2)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指针</span></span><br><span class="line"><span class="keyword">var</span> v3 *<span class="keyword">int</span>   <span class="comment">// &lt;nil&gt;</span></span><br><span class="line">v4 := <span class="built_in">new</span>(<span class="keyword">int</span>)  <span class="comment">// 0xc00001c0d0 -&gt; 初始值为0</span></span><br><span class="line">fmt.Println(v3, v4)</span><br></pre></td></tr></table></figure><ul><li>new关键字创建内存并进行内部数据的初始化，并返回一个指针类型。</li><li>nil nil在<code>go</code>语言中表示空值。</li></ul><h3 id="1-4-超大整形"><a href="#1-4-超大整形" class="headerlink" title="1.4 超大整形"></a>1.4 超大整形</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 big.Int</span><br><span class="line"><span class="comment">// 在超大整形的对象中写入一些值</span></span><br><span class="line">s1.SetInt64(<span class="number">2020</span>)</span><br><span class="line">s1.SetString(<span class="string">"9082173189999999999999"</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">fmt.Println(s1)</span><br><span class="line"></span><br><span class="line">s3 := <span class="built_in">new</span>(big.Int) <span class="comment">// 初始化一块内存地址</span></span><br><span class="line">s3.SetInt64(<span class="number">2022</span>)</span><br><span class="line">fmt.Println(s3)</span><br><span class="line">使用<span class="built_in">new</span>初始化方式效率更好，直接开辟内存空间。</span><br></pre></td></tr></table></figure><ul><li><p>超大整形相加</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 超大整形值相加</span></span><br><span class="line"><span class="comment">// 方式一</span></span><br><span class="line">n1 := <span class="built_in">new</span>(big.Int)</span><br><span class="line">n1.SetInt64(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">n2 := <span class="built_in">new</span>(big.Int)</span><br><span class="line">n2.SetInt64(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">res := <span class="built_in">new</span>(big.Int)</span><br><span class="line">res.Add(n1, n2)</span><br><span class="line">fmt.Println(res)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式二:</span></span><br><span class="line">n1 := big.NewInt(<span class="number">10</span>)</span><br><span class="line">n2 := big.NewInt(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">res := <span class="built_in">new</span>(big.Int)</span><br><span class="line"><span class="comment">// 加</span></span><br><span class="line">res.Add(n1, n2)</span><br><span class="line"><span class="comment">// 减</span></span><br><span class="line">res.Sub(n1, n2)</span><br><span class="line"><span class="comment">// 乘</span></span><br><span class="line">res.Mul(n1, n2)</span><br><span class="line"><span class="comment">// 除</span></span><br><span class="line">res.Div(n1, n2)</span><br><span class="line"></span><br><span class="line">fmt.Println(res)</span><br><span class="line"></span><br><span class="line">fmt.Println(res.Int64(), res.String()) <span class="comment">// 转成int和string</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>超大整形相加示例</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">h1 := <span class="built_in">new</span>(big.Int)</span><br><span class="line">h1.SetString(<span class="string">"918293481248912748231747823"</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">h2 := <span class="built_in">new</span>(big.Int)</span><br><span class="line">h2.SetString(<span class="string">"1203129834124782374892"</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">result := <span class="built_in">new</span>(big.Int)</span><br><span class="line">result.Add(h1, n2)</span><br><span class="line">fmt.Println(result.String())</span><br><span class="line"><span class="comment">// 918293481248912748231747843</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      Go语言数据类型
    
    </summary>
    
    
      <category term="GO" scheme="https://shuke163.github.io/categories/GO/"/>
    
    
      <category term="GO" scheme="https://shuke163.github.io/tags/GO/"/>
    
  </entry>
  
  <entry>
    <title>How to Automate Jenkins job configurations as code</title>
    <link href="https://shuke163.github.io/2020/06/08/How-to-Automate-Jenkins-job-configurations-as-code/"/>
    <id>https://shuke163.github.io/2020/06/08/How-to-Automate-Jenkins-job-configurations-as-code/</id>
    <published>2020-06-08T09:06:37.000Z</published>
    <updated>2020-06-08T09:35:52.075Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Automatically-generating-Jenkins-jobs-Step-by-step-guide"><a href="#Automatically-generating-Jenkins-jobs-Step-by-step-guide" class="headerlink" title="Automatically generating Jenkins jobs: Step-by-step guide"></a>Automatically generating Jenkins jobs: Step-by-step guide</h2><ol><li><p>pip install virtualenv</p></li><li><p>virtualenv .venv</p></li><li><p>source .venv/bin/activate</p></li><li><p>pip install jenkins-job-builder</p></li><li><p>mkdir jenkins-job-auto-create ; cd jenkins-job-auto-create</p></li><li><p>vim jenkins_jobs.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[jenkins]</span><br><span class="line">user&#x3D;shuke</span><br><span class="line">password&#x3D;aslongas</span><br><span class="line">url&#x3D;http:&#x2F;&#x2F;jenkins.shuke.com:8080</span><br><span class="line"></span><br><span class="line">[job_builder]</span><br><span class="line">ignore_cache&#x3D;True</span><br><span class="line">keep_descriptions&#x3D;False</span><br><span class="line">include_path&#x3D;.</span><br><span class="line">recursive&#x3D;False</span><br><span class="line">allow_duplicates&#x3D;False</span><br></pre></td></tr></table></figure></li><li><p>vim project_pipeline_test01.yaml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(base) ➜  jenkins_jobs cat project_pipeline_test01.yaml</span><br><span class="line">- job:</span><br><span class="line">    name: Jenkins-auto-config</span><br><span class="line">    project-type: pipeline</span><br><span class="line">    dsl: |</span><br><span class="line">      @Library(&#39;CIPipelineUtilities&#39;) _</span><br><span class="line">      testSuite &#123;</span><br><span class="line">          envName&#x3D;&quot;BTS_EU&quot;</span><br><span class="line">          suiteName&#x3D;&quot;MonitorTest&quot;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></li><li><p>jenkins-jobs –conf jenkins_jobs.ini update project_pipeline_test01.yaml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) ➜  jenkins_jobs jenkins-jobs --conf jenkins_jobs.ini update project_pipeline_test01.yaml</span><br><span class="line">INFO:jenkins_jobs.cli.subcommand.update:Updating jobs in [&#39;project_pipeline_test01.yaml&#39;] ([])</span><br><span class="line">INFO:jenkins_jobs.builder:Number of jobs generated:  1</span><br><span class="line">INFO:jenkins_jobs.builder:Reconfiguring jenkins job Jenkins-auto-config</span><br><span class="line">INFO:jenkins_jobs.cli.subcommand.update:Number of jobs updated: 1</span><br><span class="line">INFO:jenkins_jobs.builder:Number of views generated:  0</span><br><span class="line">INFO:jenkins_jobs.cli.subcommand.update:Number of views updated: 0</span><br></pre></td></tr></table></figure></li><li><p>Jenkins job created automatic</p></li><li><p>folder-jobs.yaml</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- job-template:</span><br><span class="line">    name: &#39;folder-&#123;name&#125;&#39;</span><br><span class="line">    project-type: folder</span><br><span class="line"></span><br><span class="line">- project:</span><br><span class="line">    name: devops</span><br><span class="line">    jobs:</span><br><span class="line">    - &#39;folder-&#123;name&#125;&#39;</span><br></pre></td></tr></table></figure></li><li><p>create folder-jobs</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) ➜  jenkins_jobs jenkins-jobs --conf jenkins_jobs.ini update folder-jobs.yaml</span><br><span class="line">INFO:jenkins_jobs.cli.subcommand.update:Updating jobs in [&#39;folder-jobs.yaml&#39;] ([])</span><br><span class="line">INFO:jenkins_jobs.builder:Number of jobs generated:  1</span><br><span class="line">INFO:jenkins_jobs.builder:Reconfiguring jenkins job folder-devops</span><br><span class="line">INFO:jenkins_jobs.cli.subcommand.update:Number of jobs updated: 1</span><br><span class="line">INFO:jenkins_jobs.builder:Number of views generated:  0</span><br><span class="line">INFO:jenkins_jobs.cli.subcommand.update:Number of views updated: 0</span><br></pre></td></tr></table></figure></li><li><p>install<br><a href="https://jenkins-autojobs.readthedocs.io/en/latest/" target="_blank" rel="noopener">jenkins-autojobs</a></p></li><li><p>Quck start Guide<br><a href="https://docs.openstack.org/infra/jenkins-job-builder/quick-start.html#use-case-3-working-with-json-job-definitions" target="_blank" rel="noopener">Quck Start</a><br><a href="https://docs.openstack.org/infra/jenkins-job-builder/definition.html#default-values-for-template-variables" target="_blank" rel="noopener">Job Definitions</a></p></li></ol>]]></content>
    
    <summary type="html">
    
      How to Automate Jenkins job configurations as code
    
    </summary>
    
    
      <category term="DevOps" scheme="https://shuke163.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://shuke163.github.io/tags/DevOps/"/>
    
  </entry>
  
  <entry>
    <title>python httpx lib</title>
    <link href="https://shuke163.github.io/2020/06/06/python-httpx-lib/"/>
    <id>https://shuke163.github.io/2020/06/06/python-httpx-lib/</id>
    <published>2020-06-06T04:03:19.000Z</published>
    <updated>2020-06-06T05:35:51.326Z</updated>
    
    <content type="html"><![CDATA[<h2 id="导入httpx"><a href="#导入httpx" class="headerlink" title="导入httpx"></a>导入<code>httpx</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [25]: import httpx</span><br></pre></td></tr></table></figure><p>获取一个网页</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [26]: r &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;)</span><br><span class="line"></span><br><span class="line">In [27]: r</span><br><span class="line">Out[27]: &lt;Response [200 OK]&gt;</span><br></pre></td></tr></table></figure><p>同样,发送<code>HTTP POST</code>请求:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [28]: r &#x3D; httpx.post(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;, data&#x3D;&#123;&quot;key&quot;: &quot;value&quot;&#125;)</span><br><span class="line"></span><br><span class="line">In [29]: r</span><br><span class="line">Out[29]: &lt;Response [200 OK]&gt;</span><br></pre></td></tr></table></figure><p>PUT,DELETE,HEAD和OPTIONS请求都遵循相同的方式:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [35]: r &#x3D; httpx.put(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;put&quot;, data&#x3D;&#123;&quot;key&quot;: &quot;value&quot;&#125;)</span><br><span class="line"></span><br><span class="line">In [36]: r &#x3D; httpx.delete(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;delete&quot;)</span><br><span class="line"></span><br><span class="line">In [37]: r &#x3D; httpx.head(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;)</span><br><span class="line"></span><br><span class="line">In [38]: r &#x3D; httpx.options(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;)</span><br></pre></td></tr></table></figure><h2 id="在URL中传递参数"><a href="#在URL中传递参数" class="headerlink" title="在URL中传递参数"></a>在<code>URL</code>中传递参数</h2><ol><li>在请求URL中传递查询参数,请使用<code>params</code>关键字<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [41]: r &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;, params&#x3D;params)</span><br><span class="line"></span><br><span class="line">In [42]: r</span><br><span class="line">Out[42]: &lt;Response [200 OK]&gt;</span><br><span class="line"></span><br><span class="line"># 检查发出请求结果的&#96;URL&#96;</span><br><span class="line">In [43]: r.url</span><br><span class="line">Out[43]: URL(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;get?key1&#x3D;value2&amp;key2&#x3D;value2&#39;)</span><br></pre></td></tr></table></figure></li><li>将项目列表作为值传递<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [44]: params &#x3D; &#123;&quot;key1&quot;: &quot;value2&quot;, &quot;key2&quot;: [&quot;value2&quot;, &quot;value3&quot;]&#125;</span><br><span class="line"></span><br><span class="line">In [45]: r &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;, params&#x3D;params)</span><br><span class="line"></span><br><span class="line">In [46]: r.url</span><br><span class="line">Out[46]: URL(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;get?key1&#x3D;value2&amp;key2&#x3D;value2&amp;key2&#x3D;value3&#39;)</span><br></pre></td></tr></table></figure></li></ol><h2 id="响应内容"><a href="#响应内容" class="headerlink" title="响应内容"></a>响应内容</h2><p>HTTPX将自动处理响应内容解码为<code>Unicode</code>文本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">In [52]: r &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;www.example.org&#x2F;&quot;)</span><br><span class="line"></span><br><span class="line">In [53]: r.text</span><br><span class="line">Out[53]: &#39;&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Example Domain&lt;&#x2F;title&gt;\n\n    &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;\n    &lt;meta http-equiv&#x3D;&quot;Content-type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt;\n    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot; &#x2F;&gt;\n    &lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;\n    body &#123;\n        background-color: #f0f0f2;\n        margin: 0;\n        padding: 0;\n        font-family: -apple-system, system-ui, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Open Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;\n        \n    &#125;\n    div &#123;\n        width: 600px;\n        margin: 5em auto;\n        padding: 2em;\n        background-color: #fdfdff;\n        border-radius: 0.5em;\n        box-shadow: 2px 3px 7px 2px rgba(0,0,0,0.02);\n    &#125;\n    a:link, a:visited &#123;\n        color: #38488f;\n        text-decoration: none;\n    &#125;\n    @media (max-width: 700px) &#123;\n        div &#123;\n            margin: 0 auto;\n            width: auto;\n        &#125;\n    &#125;\n    &lt;&#x2F;style&gt;    \n&lt;&#x2F;head&gt;\n\n&lt;body&gt;\n&lt;div&gt;\n    &lt;h1&gt;Example Domain&lt;&#x2F;h1&gt;\n    &lt;p&gt;This domain is for use in illustrative examples in documents. You may use this\n    domain in literature without prior coordination or asking for permission.&lt;&#x2F;p&gt;\n    &lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;www.iana.org&#x2F;domains&#x2F;example&quot;&gt;More information...&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;\n&lt;&#x2F;div&gt;\n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;\n&#39;</span><br><span class="line"></span><br><span class="line"># 解码</span><br><span class="line">In [54]: r.encoding</span><br><span class="line">Out[54]: &#39;UTF-8&#39;</span><br><span class="line"></span><br><span class="line"># 设置需要使用的编码</span><br><span class="line">In [55]: r.encoding &#x3D; &quot;ISO-8859-1&quot;</span><br><span class="line"></span><br><span class="line">In [56]: print(r.headers, r.http_version, r.url, r.status_code)</span><br><span class="line">Headers(&#123;&#39;content-encoding&#39;: &#39;gzip&#39;, &#39;age&#39;: &#39;532553&#39;, &#39;cache-control&#39;: &#39;max-age&#x3D;604800&#39;, &#39;content-type&#39;: &#39;text&#x2F;html; charset&#x3D;UTF-8&#39;, &#39;date&#39;: &#39;Sat, 06 Jun 2020 04:22:26 GMT&#39;, &#39;etag&#39;: &#39;&quot;3147526947+gzip&quot;&#39;, &#39;expires&#39;: &#39;Sat, 13 Jun 2020 04:22:26 GMT&#39;, &#39;last-modified&#39;: &#39;Thu, 17 Oct 2019 07:18:26 GMT&#39;, &#39;server&#39;: &#39;ECS (oxr&#x2F;830C)&#39;, &#39;vary&#39;: &#39;Accept-Encoding&#39;, &#39;x-cache&#39;: &#39;HIT&#39;, &#39;content-length&#39;: &#39;648&#39;&#125;) HTTP&#x2F;1.1 https:&#x2F;&#x2F;www.example.org&#x2F; 200</span><br></pre></td></tr></table></figure><h2 id="返回JSON响应内容"><a href="#返回JSON响应内容" class="headerlink" title="返回JSON响应内容"></a>返回JSON响应内容</h2><p>通常, Web API 响应将被编码为JSON</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [59]: r &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;api.github.com&#x2F;events&quot;)</span><br><span class="line">In [60]: r.json()</span><br></pre></td></tr></table></figure><h2 id="自定义header"><a href="#自定义header" class="headerlink" title="自定义header"></a>自定义<code>header</code></h2><p>要在传出请求中包含其他标头,请使用<code>header</code>关键字参数:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [60]: url &#x3D; &#39;http:&#x2F;&#x2F;httpbin.org&#x2F;headers&#39;</span><br><span class="line"></span><br><span class="line">In [61]: headers &#x3D; &#123;&quot;user-agent&quot;: &quot;my-app&#x2F;0.0.1&quot;&#125;</span><br><span class="line"></span><br><span class="line">In [62]: r &#x3D; httpx.get(url, headers&#x3D;headers)</span><br></pre></td></tr></table></figure><h2 id="发送表单数据"><a href="#发送表单数据" class="headerlink" title="发送表单数据"></a>发送表单数据</h2><p>某些类型的HTTP请求,如<code>POST|PUT</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">In [64]: data &#x3D; &#123;&quot;key1&quot;:&quot;value1&quot;, &quot;key1&quot;: &quot;value2&quot;&#125;</span><br><span class="line"></span><br><span class="line">In [65]: r &#x3D; httpx.post(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;, data&#x3D;data)</span><br><span class="line"></span><br><span class="line">In [66]: print(r.text)</span><br><span class="line">&#123;</span><br><span class="line">  &quot;args&quot;: &#123;&#125;,</span><br><span class="line">  &quot;data&quot;: &quot;&quot;,</span><br><span class="line">  &quot;files&quot;: &#123;&#125;,</span><br><span class="line">  &quot;form&quot;: &#123;</span><br><span class="line">    &quot;key1&quot;: &quot;value2&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;headers&quot;: &#123;</span><br><span class="line">    &quot;Accept&quot;: &quot;*&#x2F;*&quot;,</span><br><span class="line">    &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="line">    &quot;Content-Length&quot;: &quot;11&quot;,</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application&#x2F;x-www-form-urlencoded&quot;,</span><br><span class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;,</span><br><span class="line">    &quot;User-Agent&quot;: &quot;python-httpx&#x2F;0.12.1&quot;,</span><br><span class="line">    &quot;X-Amzn-Trace-Id&quot;: &quot;Root&#x3D;1-5edb1e61-86ac64e4f9f165244f4dbd68&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;json&quot;: null,</span><br><span class="line">  &quot;origin&quot;: &quot;114.113.113.186&quot;,</span><br><span class="line">  &quot;url&quot;: &quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>表单编码的数据还可以包括给定键的多个值:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">In [72]: data &#x3D; &#123;&quot;userList&quot;: [&quot;shuke&quot;, &quot;jack&quot;]&#125;</span><br><span class="line"></span><br><span class="line">In [73]: r &#x3D; httpx.post(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;, data&#x3D;data)</span><br><span class="line"></span><br><span class="line">In [74]: print(r.text)</span><br><span class="line">&#123;</span><br><span class="line">  &quot;args&quot;: &#123;&#125;,</span><br><span class="line">  &quot;data&quot;: &quot;&quot;,</span><br><span class="line">  &quot;files&quot;: &#123;&#125;,</span><br><span class="line">  &quot;form&quot;: &#123;</span><br><span class="line">    &quot;userList&quot;: [</span><br><span class="line">      &quot;shuke&quot;,</span><br><span class="line">      &quot;jack&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;headers&quot;: &#123;</span><br><span class="line">    &quot;Accept&quot;: &quot;*&#x2F;*&quot;,</span><br><span class="line">    &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="line">    &quot;Content-Length&quot;: &quot;28&quot;,</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application&#x2F;x-www-form-urlencoded&quot;,</span><br><span class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;,</span><br><span class="line">    &quot;User-Agent&quot;: &quot;python-httpx&#x2F;0.12.1&quot;,</span><br><span class="line">    &quot;X-Amzn-Trace-Id&quot;: &quot;Root&#x3D;1-5edb1fc2-33761faf662f0b832cb806bb&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;json&quot;: null,</span><br><span class="line">  &quot;origin&quot;: &quot;114.113.113.186&quot;,</span><br><span class="line">  &quot;url&quot;: &quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发送分段文件上传<br>使用HTTP分段编码上传文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [76]: files &#x3D; &#123;&quot;upload-file&quot;: open(&quot;&#x2F;Users&#x2F;shuke&#x2F;Work&#x2F;pha&#x2F;docker-compose.yml&quot;, &quot;rb&quot;)&#125;</span><br><span class="line"></span><br><span class="line">In [77]: r &#x3D; httpx.post(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;, files&#x3D;files)</span><br><span class="line"></span><br><span class="line">In [78]: print(r.text)</span><br></pre></td></tr></table></figure><p>发送JSON编码数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">In [79]: data &#x3D; &#123;&quot;integer&quot;: 123, &quot;boolean&quot;: True, &quot;list&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]&#125;</span><br><span class="line"></span><br><span class="line">In [80]: r &#x3D; httpx.post(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;, json&#x3D;data)</span><br><span class="line"></span><br><span class="line">In [81]: print(r.text)</span><br><span class="line">&#123;</span><br><span class="line">  &quot;args&quot;: &#123;&#125;,</span><br><span class="line">  &quot;data&quot;: &quot;&#123;\&quot;integer\&quot;: 123, \&quot;boolean\&quot;: true, \&quot;list\&quot;: [\&quot;a\&quot;, \&quot;b\&quot;, \&quot;c\&quot;]&#125;&quot;,</span><br><span class="line">  &quot;files&quot;: &#123;&#125;,</span><br><span class="line">  &quot;form&quot;: &#123;&#125;,</span><br><span class="line">  &quot;headers&quot;: &#123;</span><br><span class="line">    &quot;Accept&quot;: &quot;*&#x2F;*&quot;,</span><br><span class="line">    &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="line">    &quot;Content-Length&quot;: &quot;58&quot;,</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application&#x2F;json&quot;,</span><br><span class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;,</span><br><span class="line">    &quot;User-Agent&quot;: &quot;python-httpx&#x2F;0.12.1&quot;,</span><br><span class="line">    &quot;X-Amzn-Trace-Id&quot;: &quot;Root&#x3D;1-5edb217c-cd09ef8caa55514051957eb8&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;json&quot;: &#123;</span><br><span class="line">    &quot;boolean&quot;: true,</span><br><span class="line">    &quot;integer&quot;: 123,</span><br><span class="line">    &quot;list&quot;: [</span><br><span class="line">      &quot;a&quot;,</span><br><span class="line">      &quot;b&quot;,</span><br><span class="line">      &quot;c&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;origin&quot;: &quot;114.113.113.186&quot;,</span><br><span class="line">  &quot;url&quot;: &quot;https:&#x2F;&#x2F;httpbin.org&#x2F;post&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="响应状态码"><a href="#响应状态码" class="headerlink" title="响应状态码"></a>响应状态码</h2><p>检查响应的<code>HTTP</code>状态码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [82]: r &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;get&quot;)</span><br><span class="line"></span><br><span class="line">In [83]: r.status_code</span><br><span class="line">Out[83]: 200</span><br></pre></td></tr></table></figure><p>HTTPX还包括一个简单的快捷方式,用于通过其文本短语访问状态代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [84]: r.status_code &#x3D;&#x3D; httpx.codes.OK</span><br><span class="line">Out[84]: True</span><br></pre></td></tr></table></figure><p>针对任何客户端或服务器错误响应(4xx或5xx状态代码) 引发异常:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In [85]: not_found &#x3D; httpx.get(&quot;https:&#x2F;&#x2F;httpbin.org&#x2F;status&#x2F;404&quot;)</span><br><span class="line"></span><br><span class="line">In [86]: not_found.status_code</span><br><span class="line">Out[86]: 404</span><br><span class="line"></span><br><span class="line">In [87]: not_found.rasise_for_status()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">AttributeError                            Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-87-c7b57e835640&gt; in &lt;module&gt;</span><br><span class="line">----&gt; 1 not_found.rasise_for_status()</span><br><span class="line"></span><br><span class="line">AttributeError: &#39;Response&#39; object has no attribute &#39;rasise_for_status&#39;</span><br></pre></td></tr></table></figure><h2 id="响应Headers"><a href="#响应Headers" class="headerlink" title="响应Headers"></a>响应Headers</h2><p>响应标头可作为类似于字典的接口使用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [88]: r.headers</span><br><span class="line">Out[88]: Headers(&#123;&#39;date&#39;: &#39;Sat, 06 Jun 2020 04:56:56 GMT&#39;, &#39;content-type&#39;: &#39;application&#x2F;json&#39;, &#39;content-length&#39;: &#39;306&#39;, &#39;connection&#39;: &#39;keep-alive&#39;, &#39;server&#39;: &#39;gunicorn&#x2F;19.9.0&#39;, &#39;access-control-allow-origin&#39;: &#39;*&#39;, &#39;access-control-allow-credentials&#39;: &#39;true&#39;&#125;)</span><br></pre></td></tr></table></figure><h2 id="该Headers数据类型是不区分大小写的，所以你可以使用任何资本"><a href="#该Headers数据类型是不区分大小写的，所以你可以使用任何资本" class="headerlink" title="该Headers数据类型是不区分大小写的，所以你可以使用任何资本"></a>该<code>Headers</code>数据类型是不区分大小写的，所以你可以使用任何资本</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [89]: r.headers[&quot;Content-Type&quot;]</span><br><span class="line">Out[89]: &#39;application&#x2F;json&#39;</span><br><span class="line"></span><br><span class="line">In [90]: r.headers.get(&quot;content-type&quot;)</span><br><span class="line">Out[90]: &#39;application&#x2F;json&#39;</span><br></pre></td></tr></table></figure><h2 id="流响应"><a href="#流响应" class="headerlink" title="流响应"></a>流响应</h2><blockquote><p>可以流式传输响应的二进制内容</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [91]: with httpx.stream(&quot;GET&quot;, &quot;https:&#x2F;&#x2F;www.example.com&quot;) as r:</span><br><span class="line">    ...:     for data in r.iter_bytes():</span><br><span class="line">    ...:         print(data)</span><br></pre></td></tr></table></figure><p>或文字…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [93]: with httpx.stream(&quot;GET&quot;, &quot;https:&#x2F;&#x2F;www.example.com&quot;) as r:</span><br><span class="line">    ...:     for text in r.iter_text():</span><br><span class="line">    ...:         print(text)</span><br></pre></td></tr></table></figure><p>或逐行流文本…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [96]: with httpx.stream(&quot;GET&quot;, &quot;https:&#x2F;&#x2F;www.example.com&quot;) as r:</span><br><span class="line">    ...:     for text in r.iter_lines():</span><br><span class="line">    ...:         print(text)</span><br></pre></td></tr></table></figure><h2 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h2><p>可以轻松访问响应中设置的任何cookie:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [97]: r &#x3D; httpx.get(&quot;http:&#x2F;&#x2F;httpbin.org&#x2F;cookies&#x2F;set?chocolate&#x3D;chip&quot;, allow_redirects&#x3D;False)</span><br><span class="line"></span><br><span class="line">In [98]: r.cookies[&quot;chocolate&quot;]</span><br><span class="line">Out[98]: &#39;chip&#39;</span><br></pre></td></tr></table></figure><p>如果需要将<code>Cookies</code>包含在外发请求中,请使用<code>cookies</code>参数:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [99]: cookies &#x3D; &#123;&quot;peanut&quot;: &quot;butter&quot;&#125;</span><br><span class="line"></span><br><span class="line">In [100]: r &#x3D; httpx.get(&quot;http:&#x2F;&#x2F;httpbin.org&#x2F;cookies&quot;, cookies&#x3D;cookies)</span><br><span class="line"></span><br><span class="line">In [101]: r.json()</span><br><span class="line">Out[101]: &#123;&#39;cookies&#39;: &#123;&#39;peanut&#39;: &#39;butter&#39;&#125;&#125;</span><br></pre></td></tr></table></figure><p><code>Cookies</code> 按 域访问设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">In [102]: cookies &#x3D; httpx.Cookies()</span><br><span class="line"></span><br><span class="line">In [103]: cookies.set(&#39;cookie_on_domain&#39;, &#39;hello, there!&#39;, domain&#x3D;&#39;httpbin.org&#39;)</span><br><span class="line"></span><br><span class="line">In [104]: cookies.set(&#39;cookies_off_domain&#39;, &#39;nope&#39;, domain&#x3D;&quot;example.org&quot;)</span><br><span class="line"></span><br><span class="line">In [105]: r &#x3D; httpx.get(&quot;http:&#x2F;&#x2F;httpbin.org&#x2F;cookies&quot;, cookies&#x3D;cookies)</span><br><span class="line"></span><br><span class="line">In [106]: r.json()</span><br><span class="line">Out[106]: &#123;&#39;cookies&#39;: &#123;&#39;cookie_on_domain&#39;: &#39;hello, there!&#39;&#125;&#125;</span><br></pre></td></tr></table></figure><p><code>URL</code> 重定向和历史<br>默认情况下,HTTPX将对重定向执行除<code>HEAD</code>请求之外的任何操作。<br><code>history</code>响应的属性可用于检查所有后续重定向,它包含遵循他们的顺序的所有重定向响应的列表<br><code>GITHUB</code>将所有<code>HTTP</code>请求重定向到<code>HTTPS</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">In [107]: r &#x3D; httpx.get(&quot;http:&#x2F;&#x2F;github.com&quot;)</span><br><span class="line"></span><br><span class="line">In [108]: r.url</span><br><span class="line">Out[108]: URL(&#39;https:&#x2F;&#x2F;github.com&#39;)</span><br><span class="line"></span><br><span class="line">In [109]: r.status_code</span><br><span class="line">Out[109]: 200</span><br><span class="line"></span><br><span class="line">In [110]: r.history</span><br><span class="line">Out[110]: []</span><br></pre></td></tr></table></figure><p>您可以使用allow_redirects参数修改默认的重定向处理:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [113]: r &#x3D; httpx.head(&#39;http:&#x2F;&#x2F;github.com&#x2F;&#39;, allow_redirects&#x3D;True)</span><br><span class="line"></span><br><span class="line">In [114]: r.url</span><br><span class="line">Out[114]: URL(&#39;https:&#x2F;&#x2F;github.com&#x2F;&#39;)</span><br></pre></td></tr></table></figure><h2 id="认证方式"><a href="#认证方式" class="headerlink" title="认证方式"></a>认证方式</h2><ol><li><p>HTTPX支持基本和摘要HTTP身份验证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [122]: httpx.get(&quot;https:&#x2F;&#x2F;example.com&quot;, auth&#x3D;(&quot;my_user&quot;, &quot;password123&quot;))</span><br><span class="line">     ...:</span><br><span class="line">Out[122]: &lt;Response [200 OK]&gt;</span><br></pre></td></tr></table></figure></li><li><p>摘要式身份验证的凭据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [123]: auth &#x3D; httpx.DigestAuth(&quot;my_user&quot;, &quot;password123&quot;)</span><br><span class="line"></span><br><span class="line">In [124]: httpx.get(&quot;https:&#x2F;&#x2F;example.com&quot;, auth&#x3D;auth)</span><br><span class="line">Out[124]: &lt;Response [200 OK]&gt;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      python httpx lib
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>Linux Shell cat EOF 中变量引用</title>
    <link href="https://shuke163.github.io/2020/05/30/Linux-Shell-cat-EOF-%E4%B8%AD%E5%8F%98%E9%87%8F%E5%BC%95%E7%94%A8/"/>
    <id>https://shuke163.github.io/2020/05/30/Linux-Shell-cat-EOF-%E4%B8%AD%E5%8F%98%E9%87%8F%E5%BC%95%E7%94%A8/</id>
    <published>2020-05-30T13:38:18.000Z</published>
    <updated>2020-05-30T13:46:26.771Z</updated>
    
    <content type="html"><![CDATA[<p>cat输出多行文本到文件的方法很常用，如何在里面引用变量呢？看下面的代码:<br>设置环境变量<code>LDAP_SERVER_URI</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LDAP_SERVER_URI&#x3D;&quot;ldaps:&#x2F;&#x2F;tldap.shuke.com&quot;</span><br></pre></td></tr></table></figure><p><code>cat-eof.sh</code>文件内容如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env bash</span><br><span class="line">cat &lt;&lt;EOF &gt; .&#x2F;test.yml</span><br><span class="line">123</span><br><span class="line">shuke</span><br><span class="line">example: $&#123;LDAP_SERVER_URI&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>查看文件内容:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">➜  &#x2F;tmp bash cat-eof.sh</span><br><span class="line">➜  &#x2F;tmp cat test.yml</span><br><span class="line">123</span><br><span class="line">shuke</span><br><span class="line">example: ldaps:&#x2F;&#x2F;tldap.shuke.com</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      Linux Shell cat EOF 中变量引用
    
    </summary>
    
    
      <category term="LINUX" scheme="https://shuke163.github.io/categories/LINUX/"/>
    
    
      <category term="LINUX" scheme="https://shuke163.github.io/tags/LINUX/"/>
    
  </entry>
  
  <entry>
    <title>GitOps for k8s</title>
    <link href="https://shuke163.github.io/2020/05/28/GitOps-for-k8s/"/>
    <id>https://shuke163.github.io/2020/05/28/GitOps-for-k8s/</id>
    <published>2020-05-28T01:42:56.000Z</published>
    <updated>2020-05-28T01:43:45.303Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/s/ptcccaFY55wBKdeNqpu8cw" target="_blank" rel="noopener">gitops for k8s</a></p>]]></content>
    
    <summary type="html">
    
      GitOps for k8s
    
    </summary>
    
    
      <category term="k8s" scheme="https://shuke163.github.io/categories/k8s/"/>
    
    
      <category term="k8s" scheme="https://shuke163.github.io/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>DevOps工具主题整理</title>
    <link href="https://shuke163.github.io/2020/05/22/DevOps%E5%B7%A5%E5%85%B7%E4%B8%BB%E9%A2%98%E6%95%B4%E7%90%86/"/>
    <id>https://shuke163.github.io/2020/05/22/DevOps%E5%B7%A5%E5%85%B7%E4%B8%BB%E9%A2%98%E6%95%B4%E7%90%86/</id>
    <published>2020-05-22T03:53:30.000Z</published>
    <updated>2020-06-08T09:40:32.157Z</updated>
    
    <content type="html"><![CDATA[<img src="DevOps工具主题整理/DevOps.svg">]]></content>
    
    <summary type="html">
    
      DevOps工具主题整理
    
    </summary>
    
    
      <category term="DevOps" scheme="https://shuke163.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://shuke163.github.io/tags/DevOps/"/>
    
  </entry>
  
  <entry>
    <title>python轻量级框架</title>
    <link href="https://shuke163.github.io/2020/05/05/python%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%A1%86%E6%9E%B6/"/>
    <id>https://shuke163.github.io/2020/05/05/python%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%A1%86%E6%9E%B6/</id>
    <published>2020-05-04T18:06:57.000Z</published>
    <updated>2020-05-04T19:08:01.293Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Responder框架"><a href="#Responder框架" class="headerlink" title="Responder框架"></a>Responder框架</h2><blockquote><p>responder是@kennethreitz新开发的一个项目， 是一个基于 Python 的 HTTP 服务框架. 底层用了 Starlette 的框架, Starlette 是一款轻量级的 ASGI 框架/工具包， 可以用 Starlette 构建高性能的异步 IO 服务.</p></blockquote><p>示例代码如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#! &#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">@version: v0.1</span><br><span class="line">@Author: shu_ke163@163.com</span><br><span class="line">@Description: file content</span><br><span class="line">@Date: 2020-05-05 01:04:37</span><br><span class="line">@LastEditors: shuke</span><br><span class="line">@LastEditTime: 2020-05-05 02:07:37</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">import time</span><br><span class="line">import graphene</span><br><span class="line">import responder</span><br><span class="line"></span><br><span class="line">api &#x3D; responder.API()</span><br><span class="line"></span><br><span class="line">@api.route(&quot;&#x2F;&#123;greeting&#125;&quot;)</span><br><span class="line">async def greet_world(req, resp, *, greeting):</span><br><span class="line">    resp.text &#x3D; f&quot;&#123;greeting&#125;, world&quot;</span><br><span class="line"></span><br><span class="line">@api.route(&quot;&#x2F;&quot;)</span><br><span class="line">def hello(req, resp):</span><br><span class="line"></span><br><span class="line">    # 作为后台任务执行</span><br><span class="line">    @api.background.task</span><br><span class="line">    def sleep(s&#x3D;10):</span><br><span class="line">        time.sleep(s)</span><br><span class="line">        print(&quot;slept!&quot;)</span><br><span class="line"></span><br><span class="line">    sleep()</span><br><span class="line">    resp.content &#x3D; &quot;processing&quot;</span><br><span class="line"></span><br><span class="line">class Query(graphene.ObjectType):</span><br><span class="line">    hello &#x3D; graphene.String(name&#x3D;graphene.String(default_value&#x3D;&quot;stranger&quot;))</span><br><span class="line"></span><br><span class="line">    def resolve_hello(self, info, name):</span><br><span class="line">        return f&quot;Hello &#123;name&#125;&quot;</span><br><span class="line"></span><br><span class="line">schema &#x3D; graphene.Schema(query&#x3D;Query)</span><br><span class="line">view &#x3D; responder.ext.GraphQLView(api&#x3D;api, schema&#x3D;schema)</span><br><span class="line"></span><br><span class="line">api.add_route(&quot;&#x2F;graph&quot;, view)</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    api.run()</span><br></pre></td></tr></table></figure><p><a href="https://responder.kennethreitz.org/en/latest/tour.html" target="_blank" rel="noopener">官方示例文档</a></p><h2 id="Starlette"><a href="#Starlette" class="headerlink" title="Starlette"></a>Starlette</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#! &#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">@version: v0.1</span><br><span class="line">@Author: shu_ke163@163.com</span><br><span class="line">@Description: file content</span><br><span class="line">@Date: 2020-05-05 02:16:32</span><br><span class="line">@LastEditors: shuke</span><br><span class="line">@LastEditTime: 2020-05-05 02:22:39</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line"></span><br><span class="line">from starlette.applications import Starlette</span><br><span class="line">from starlette.responses import JSONResponse</span><br><span class="line">from starlette.routing import Route</span><br><span class="line"></span><br><span class="line">async def homepage(request):</span><br><span class="line">    return JSONResponse(&#123;&quot;hello&quot;: &quot;shuke&#39;s world&quot;&#125;)</span><br><span class="line"></span><br><span class="line">routes &#x3D; [</span><br><span class="line">    Route(&quot;&#x2F;&quot;, endpoint&#x3D;homepage)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">app &#x3D; Starlette(debug&#x3D;True, routes&#x3D;routes)</span><br></pre></td></tr></table></figure><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) ➜  uvicorn example:app --reload</span><br></pre></td></tr></table></figure><h2 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(base) ➜ http http:&#x2F;&#x2F;127.0.0.1:8000</span><br><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">content-length: 25</span><br><span class="line">content-type: application&#x2F;json</span><br><span class="line">date: Mon, 04 May 2020 18:27:23 GMT</span><br><span class="line">server: uvicorn</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;hello&quot;: &quot;shuke&#39;s world&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.starlette.io/" target="_blank" rel="noopener">官方文档</a></p><h2 id="FastAPI"><a href="#FastAPI" class="headerlink" title="FastAPI"></a>FastAPI</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#! &#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">@version: v0.1</span><br><span class="line">@Author: shu_ke163@163.com</span><br><span class="line">@Description: file content</span><br><span class="line">@Date: 2020-05-05 01:04:37</span><br><span class="line">@LastEditors: shuke</span><br><span class="line">@LastEditTime: 2020-05-05 02:48:43</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line"></span><br><span class="line">from fastapi import FastAPI</span><br><span class="line"></span><br><span class="line">app &#x3D; FastAPI()</span><br><span class="line"></span><br><span class="line">@app.get(&quot;&#x2F;&quot;)</span><br><span class="line">async def read_root():</span><br><span class="line">    return &#123;&quot;hello&quot;: &quot;world!&quot;&#125;</span><br><span class="line"></span><br><span class="line">@app.get(&quot;&#x2F;items&#x2F;&#123;item_id&#125;&quot;)</span><br><span class="line">async def read_item(item_id: int, q: str &#x3D; None) -&gt; dict:</span><br><span class="line">    return &#123;&quot;item_id&quot;: item_id, &quot;q&quot;: q&#125;</span><br><span class="line"></span><br><span class="line"># 启动</span><br><span class="line">(base) ➜  learn uvicorn main:app --reload</span><br></pre></td></tr></table></figure><h2 id="请求示例"><a href="#请求示例" class="headerlink" title="请求示例"></a>请求示例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(base) ➜  http http:&#x2F;&#x2F;127.0.0.1:8000</span><br><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">content-length: 18</span><br><span class="line">content-type: application&#x2F;json</span><br><span class="line">date: Mon, 04 May 2020 18:52:08 GMT</span><br><span class="line">server: uvicorn</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;hello&quot;: &quot;world!&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(base) ➜  http http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;items&#x2F;5\?q\&#x3D;shuke</span><br><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">content-length: 25</span><br><span class="line">content-type: application&#x2F;json</span><br><span class="line">date: Mon, 04 May 2020 18:55:40 GMT</span><br><span class="line">server: uvicorn</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;item_id&quot;: 5,</span><br><span class="line">    &quot;q&quot;: &quot;shuke&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="api-docs"><a href="#api-docs" class="headerlink" title="api docs"></a>api docs</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;docs</span><br></pre></td></tr></table></figure><h2 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;learnku.com&#x2F;python&#x2F;t&#x2F;38942</span><br><span class="line">https:&#x2F;&#x2F;fastapi.tiangolo.com&#x2F;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      python轻量级框架
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>Python上下文管理器</title>
    <link href="https://shuke163.github.io/2020/05/03/Python%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/"/>
    <id>https://shuke163.github.io/2020/05/03/Python%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/</id>
    <published>2020-05-03T03:30:05.000Z</published>
    <updated>2020-05-03T03:32:21.244Z</updated>
    
    <content type="html"><![CDATA[<h2 id="有趣的python上下文管理器"><a href="#有趣的python上下文管理器" class="headerlink" title="有趣的python上下文管理器"></a>有趣的<code>python</code>上下文管理器</h2><p><a href="https://mp.weixin.qq.com/s/h0YYmehLuO8QF5Ry7b7fiQ" target="_blank" rel="noopener">原文链接</a><br><a href="https://mp.weixin.qq.com/s/rPFL7KXwD8Bof60lewqTMA" target="_blank" rel="noopener">文章</a></p>]]></content>
    
    <summary type="html">
    
      Python上下文管理器
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>EditorConfig使用介绍</title>
    <link href="https://shuke163.github.io/2020/05/03/EditorConfig%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D/"/>
    <id>https://shuke163.github.io/2020/05/03/EditorConfig%E4%BD%BF%E7%94%A8%E4%BB%8B%E7%BB%8D/</id>
    <published>2020-05-03T03:08:41.000Z</published>
    <updated>2020-05-03T03:09:10.952Z</updated>
    
    <content type="html"><![CDATA[<p>在github看到很多项目根目录都有 .editorconfig 文件，所以去了解一下。</p><p>这个文件是 EditorConfig 用来统一不同编辑器的代码风格的配置。</p><p>各种IDE的风格自然不一样，通过这样一个配置文件定义的标准统一风格，比如缩进用x个空格。再有就是多人一起协同开发一个项目，editorconfig 能起到很好的效果。</p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># EditorConfig: http:&#x2F;&#x2F;editorconfig.org&#x2F;</span><br><span class="line"></span><br><span class="line">root &#x3D; true</span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">indent_style &#x3D; space</span><br><span class="line">indent_size &#x3D; 4</span><br><span class="line">end_of_line &#x3D; lf</span><br><span class="line">charset &#x3D; utf-8</span><br><span class="line">trim_trailing_whitespace &#x3D; true</span><br><span class="line">insert_final_newline &#x3D; true</span><br><span class="line"></span><br><span class="line">[*.md]</span><br><span class="line">trim_trailing_whitespace &#x3D; false</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      EditorConfig使用介绍
    
    </summary>
    
    
      <category term="IDE" scheme="https://shuke163.github.io/categories/IDE/"/>
    
    
      <category term="IDE" scheme="https://shuke163.github.io/tags/IDE/"/>
    
  </entry>
  
  <entry>
    <title>简易HTTPS 加密证书的工具</title>
    <link href="https://shuke163.github.io/2020/05/03/%E7%AE%80%E6%98%93HTTPS-%E5%8A%A0%E5%AF%86%E8%AF%81%E4%B9%A6%E7%9A%84%E5%B7%A5%E5%85%B7/"/>
    <id>https://shuke163.github.io/2020/05/03/%E7%AE%80%E6%98%93HTTPS-%E5%8A%A0%E5%AF%86%E8%AF%81%E4%B9%A6%E7%9A%84%E5%B7%A5%E5%85%B7/</id>
    <published>2020-05-03T03:06:07.000Z</published>
    <updated>2020-05-03T03:07:48.462Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/FiloSottile/mkcert" target="_blank" rel="noopener">mkcert</a> 是生成本地 HTTPS 加密证书的工具，一个命令就可以生成证书，不需要任何配置。</p><p>在 Linux 上，安装 certutil</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install libnss3-tools</span><br><span class="line">$ sudo yum install nss-tools</span><br></pre></td></tr></table></figure><p>使用示例</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ mkcert -install</span><br><span class="line">Created a new local CA at &quot;&#x2F;Users&#x2F;filippo&#x2F;Library&#x2F;Application Support&#x2F;mkcert&quot; 💥</span><br><span class="line">The local CA is now installed in the system trust store! ⚡️</span><br><span class="line">The local CA is now installed in the Firefox trust store (requires restart)! 🦊</span><br><span class="line"></span><br><span class="line">$ mkcert example.com &#39;*.example.org&#39; myapp.dev localhost 127.0.0.1 ::1</span><br><span class="line">Using the local CA at &quot;&#x2F;Users&#x2F;filippo&#x2F;Library&#x2F;Application Support&#x2F;mkcert&quot; ✨</span><br><span class="line"></span><br><span class="line">Created a new certificate valid for the following names 📜</span><br><span class="line"> - &quot;example.com&quot;</span><br><span class="line"> - &quot;*.example.org&quot;</span><br><span class="line"> - &quot;myapp.dev&quot;</span><br><span class="line"> - &quot;localhost&quot;</span><br><span class="line"> - &quot;127.0.0.1&quot;</span><br><span class="line"> - &quot;::1&quot;</span><br><span class="line"></span><br><span class="line">The certificate is at &quot;.&#x2F;example.com+5.pem&quot; and the key at &quot;.&#x2F;example.com+5-key.pem&quot; ✅</span><br></pre></td></tr></table></figure><p><a href="https://keer.me/Using-mkcert-to-generate-local-HTTPS-certificates.html" target="_blank" rel="noopener">使用方法参考</a></p>]]></content>
    
    <summary type="html">
    
      简易HTTPS 加密证书的工具
    
    </summary>
    
    
      <category term="Nginx" scheme="https://shuke163.github.io/categories/Nginx/"/>
    
    
      <category term="Nginx" scheme="https://shuke163.github.io/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>网站文档mkdocs</title>
    <link href="https://shuke163.github.io/2020/05/03/%E7%BD%91%E7%AB%99%E6%96%87%E6%A1%A3mkdocs/"/>
    <id>https://shuke163.github.io/2020/05/03/%E7%BD%91%E7%AB%99%E6%96%87%E6%A1%A3mkdocs/</id>
    <published>2020-05-03T03:02:31.000Z</published>
    <updated>2020-05-03T03:10:25.934Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Mkdocs"><a href="#Mkdocs" class="headerlink" title="Mkdocs"></a>Mkdocs</h2><p><a href="https://www.mkdocs.org/#mkdocs" target="_blank" rel="noopener">mkdocs.org</a></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol><li>安装python2.7（安装时选中加入环境变量）</li><li>pip install mkdocs &amp; mkdocs –version</li><li>pip install click-man</li><li>mkdocs new my-project &amp; cd my-project</li><li>mkdocs serve</li><li>mkdocs build</li><li>mkdocs build –clean (清理已被删除的文档所生成的html文件)</li></ol><p>mkdocs-material主题配置<br><a href="https://squidfunk.github.io/mkdocs-material/getting-started/" target="_blank" rel="noopener">点击看效果 mkdocs-material</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. pip install mkdocs-material</span><br><span class="line">2. vim mkdocs.yml</span><br></pre></td></tr></table></figure><p>mkdocs.yml 配置示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">site_name: 文档中心</span><br><span class="line">theme:</span><br><span class="line">  name: &#39;material&#39;</span><br><span class="line">  palette:</span><br><span class="line">    primary: &#39;teal&#39;</span><br><span class="line">    accent: &#39;teal&#39;</span><br><span class="line">  font:</span><br><span class="line">    text: &#39;Roboto&#39;</span><br><span class="line">    code: &#39;Roboto Mono&#39;</span><br></pre></td></tr></table></figure><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdocs new [dir-name] - Create a new project.</span><br><span class="line">mkdocs serve - Start the live-reloading docs server.</span><br><span class="line">mkdocs build - Build the documentation site.</span><br><span class="line">mkdocs help - Print this help message.</span><br></pre></td></tr></table></figure><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdocs.yml    # The configuration file.</span><br><span class="line">docs&#x2F;</span><br><span class="line">    index.md  # The documentation homepage.</span><br><span class="line">    ...       # Other markdown pages, images and other files.</span><br></pre></td></tr></table></figure><h2 id="另外几种文档记录方式"><a href="#另外几种文档记录方式" class="headerlink" title="另外几种文档记录方式"></a>另外几种文档记录方式</h2><ul><li>gitbook</li><li>wiki</li><li>docusaurus</li><li>MM-wiki</li></ul>]]></content>
    
    <summary type="html">
    
      网站文档mkdocs
    
    </summary>
    
    
      <category term="docs" scheme="https://shuke163.github.io/categories/docs/"/>
    
    
      <category term="docs" scheme="https://shuke163.github.io/tags/docs/"/>
    
  </entry>
  
  <entry>
    <title>云存储平台Seafile</title>
    <link href="https://shuke163.github.io/2020/05/03/%E4%BA%91%E5%AD%98%E5%82%A8%E5%B9%B3%E5%8F%B0Seafile/"/>
    <id>https://shuke163.github.io/2020/05/03/%E4%BA%91%E5%AD%98%E5%82%A8%E5%B9%B3%E5%8F%B0Seafile/</id>
    <published>2020-05-03T02:58:45.000Z</published>
    <updated>2020-05-28T01:46:29.786Z</updated>
    
    <content type="html"><![CDATA[<h2 id="云存储平台seafile"><a href="#云存储平台seafile" class="headerlink" title="云存储平台seafile"></a>云存储平台seafile</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;haiwen&#x2F;seafile</span><br></pre></td></tr></table></figure><p>Seafile 的目标是给企业提供一个安全的云存储平台，满足企业文件的共享和协作的需求。</p><p>Seafile 采用开源的方式来进行产品开发。开源帮助 Seafile 成为了一个国际化的项目，并吸引了全球用户的参与和贡献。目前我们已经在 Github 开源代码托管平台上有了 3900 多个关注。全球用户的使用、反馈和审核使得 Seafile 更加的安全和稳定。</p><p>截至 2016 年初，Seafile 已经有超过 30 万用户使用，并拥有卡巴斯基，德国 Mainz 大学，德国 HU Berlin 大学和法国 Strasbourg 大学等大型组织机构客户。</p><p><a href="https://www.seafile.com/home/" target="_blank" rel="noopener">https://www.seafile.com/home/</a></p><h2 id="nextcloud"><a href="#nextcloud" class="headerlink" title="nextcloud"></a>nextcloud</h2><blockquote><p>另一个开放云盘服务</p></blockquote><h2 id="z-file"><a href="#z-file" class="headerlink" title="z-file"></a>z-file</h2><blockquote><p>另一个开放云盘服务</p></blockquote>]]></content>
    
    <summary type="html">
    
      云存储平台Seafile
    
    </summary>
    
    
      <category term="Seafile" scheme="https://shuke163.github.io/categories/Seafile/"/>
    
    
      <category term="Seafile" scheme="https://shuke163.github.io/tags/Seafile/"/>
    
  </entry>
  
  <entry>
    <title>推荐几个好用的DevOps小工具</title>
    <link href="https://shuke163.github.io/2020/04/30/%E6%8E%A8%E8%8D%90%E5%87%A0%E4%B8%AA%E5%A5%BD%E7%94%A8%E7%9A%84DevOps%E5%B0%8F%E5%B7%A5%E5%85%B7/"/>
    <id>https://shuke163.github.io/2020/04/30/%E6%8E%A8%E8%8D%90%E5%87%A0%E4%B8%AA%E5%A5%BD%E7%94%A8%E7%9A%84DevOps%E5%B0%8F%E5%B7%A5%E5%85%B7/</id>
    <published>2020-04-30T15:26:36.000Z</published>
    <updated>2020-05-06T15:40:07.241Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具推荐"><a href="#工具推荐" class="headerlink" title="工具推荐"></a>工具推荐</h2><ol><li>文档管理</li></ol><ul><li>wiki</li><li>MM-wiki</li><li>gitbook(推荐)</li><li>Docusaurus(推荐)</li><li>hexo</li></ul><ol start="2"><li>bug管理</li></ol><ul><li>git-bug</li><li>蝉道</li><li>Readme</li></ul><ol start="3"><li>code review</li></ol><ul><li>Phabricator(PHA)</li></ul><ol start="4"><li>markdown 绘图工具</li></ol><ul><li>PlantUML</li><li>Graphviz</li><li>Mermaid</li></ul>]]></content>
    
    <summary type="html">
    
      推荐几个好用的DevOps小工具
    
    </summary>
    
    
      <category term="DevOps" scheme="https://shuke163.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://shuke163.github.io/tags/DevOps/"/>
    
  </entry>
  
  <entry>
    <title>python小技巧</title>
    <link href="https://shuke163.github.io/2020/04/29/python%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
    <id>https://shuke163.github.io/2020/04/29/python%E5%B0%8F%E6%8A%80%E5%B7%A7/</id>
    <published>2020-04-29T00:46:02.000Z</published>
    <updated>2020-04-29T00:55:35.699Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>每天早晨洗一遍脑子特并清醒 </p></blockquote><ol><li><p>List: all_equal<br>功能实现: 检验一个列表中的所有元素是否都一样</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def all_equal(lst):</span><br><span class="line">    return lst[1:] &#x3D;&#x3D; lst[:-1]</span><br><span class="line"></span><br><span class="line">ret &#x3D; all_equal([1, 2, 3, 4, 5, 6])</span><br><span class="line"></span><br><span class="line">ret2 &#x3D; all_equal([1, 1, 1, 1])</span><br><span class="line"></span><br><span class="line">print(ret, ret2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># True False</span><br></pre></td></tr></table></figure></li><li><p>List: all_unique<br>功能实现: 如果列表所有值都是唯一的，返回True, 否则返回False</p><blockquote><p>解读: 在给定列表上使用集合set()去重, 比较它和原列表的长度</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def all_unique(lst):</span><br><span class="line">    return len(lst) &#x3D;&#x3D; len(set(lst))</span><br><span class="line"></span><br><span class="line"># 举例:</span><br><span class="line">x &#x3D; [1, 2, 3, 4, 5, 6]</span><br><span class="line">y &#x3D; [1, 2, 2, 3, 4, 5]</span><br><span class="line">z &#x3D; all_unique(x)</span><br><span class="line">b &#x3D; all_unique(y)</span><br><span class="line">print(z, b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># True False</span><br></pre></td></tr></table></figure></li><li><p>List: bifucate<br>功能实现: 将列表值分组。如果filter的元素是True, 那么对应的元素属于第一个组,否则属于第二个组<br>解读: 使用列表推导式和enumerate()基于fiter元素到各组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def bifurcate(lst, filter):</span><br><span class="line">    return [</span><br><span class="line">        [x for i, x in enumerate(lst) if filter[i] &#x3D;&#x3D; True],</span><br><span class="line">        [x for i, x in enumerate(lst) if filter[i] &#x3D;&#x3D; False]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">r &#x3D; bifurcate([&quot;beep&quot;, &quot;boop&quot;, &quot;foo&quot;, &quot;bar&quot;], [True, True, False, True])</span><br><span class="line"># [[&#39;beep&#39;, &#39;boop&#39;, &#39;bar&#39;], [&#39;foo&#39;]]</span><br></pre></td></tr></table></figure></li><li><p>List: difference<br>功能实现: 返回两个iterables间的差异<br>解读: 创建b的集合，使用a的列表推导式保留不在_b中的元素</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def difference(a, b):</span><br><span class="line">    _b &#x3D; set(b)</span><br><span class="line">    return [item for item in a if item not in _b]</span><br><span class="line"></span><br><span class="line">print(difference([1, 2, 3], [1, 2, 4]))</span><br><span class="line"></span><br><span class="line"># [3]</span><br></pre></td></tr></table></figure></li><li><p>Math: digitize<br>功能实现: 将一个数分解转换为个位数字<br>解读: 将n字符化后使用map()函数结合int完成转化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def digitize(n):</span><br><span class="line">    return list(map(int, str(n)))</span><br><span class="line"></span><br><span class="line">print(digitize(123))</span><br><span class="line"># [1,2,3]</span><br></pre></td></tr></table></figure></li><li><p>List: shuffle<br>功能实现: 将列表元素顺序随机打乱<br>解读: 使用Fisher-Yates算法重新排序列表元素</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from copy import deepcopy</span><br><span class="line">from random import randint</span><br><span class="line"></span><br><span class="line">def shuffle(lst):</span><br><span class="line">    temp_lst &#x3D; deepcopy(lst)</span><br><span class="line">    m &#x3D; len(temp_lst)</span><br><span class="line">    while (m):</span><br><span class="line">        m -&#x3D; 1</span><br><span class="line">        i &#x3D; randint(0, m)</span><br><span class="line">        temp_lst[m], temp_lst[i] &#x3D; temp_lst[i], temp_lst[m]</span><br><span class="line">    return temp_lst</span><br><span class="line"></span><br><span class="line">foo &#x3D; [1, 2, 3]</span><br><span class="line">print(shuffle(foo))</span><br><span class="line"></span><br><span class="line"># [2, 1, 3]</span><br></pre></td></tr></table></figure></li><li><p>Math: clamp_number<br>功能实现: 将数字num嵌在由a和b边界值规定的范围中<br>解读: 如果num落尽范围内,返回num 否则，返回范围内最接近的数字</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def clamp_number(num, a, b):</span><br><span class="line">    return max(min(num, max(a, b)), min(a, b))</span><br><span class="line"></span><br><span class="line">a &#x3D; clamp_number(2, 3, 5)</span><br><span class="line">b &#x3D; clamp_number(1, -1, -5)</span><br><span class="line">print(a, b)</span><br><span class="line"></span><br><span class="line"># 3 -1</span><br></pre></td></tr></table></figure></li><li><p>String: byte_size<br>功能实现: 返回字符串的字节数<br>解读: 使用String.encode(‘utf-8’) 解码给定字符串, 返回长度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def byte_size(string):</span><br><span class="line">    return len(string.encode(&#39;utf-8&#39;))</span><br><span class="line"></span><br><span class="line"># print(byte_size(&#39;😀&#39;)) # 4</span><br><span class="line"># print(byte_size(&#39;Hello World&#39;)) # 11</span><br></pre></td></tr></table></figure></li><li><p>Math: gcd<br>功能实现: 计算几个数的最大公因数<br>解读: 使用reduce()和math.gcd在给定列表上实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from functools import reduce</span><br><span class="line">import math</span><br><span class="line"></span><br><span class="line">def gcd(numbers):</span><br><span class="line">    return reduce(math.gcd, numbers)</span><br><span class="line"></span><br><span class="line">print(gcd([8, 36, 28]))  # 4</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      python小技巧
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>一些python相关的知识点整理</title>
    <link href="https://shuke163.github.io/2020/04/23/%E4%B8%80%E4%BA%9Bpython%E7%9B%B8%E5%85%B3%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%E6%95%B4%E7%90%86/"/>
    <id>https://shuke163.github.io/2020/04/23/%E4%B8%80%E4%BA%9Bpython%E7%9B%B8%E5%85%B3%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%E6%95%B4%E7%90%86/</id>
    <published>2020-04-23T08:29:52.000Z</published>
    <updated>2020-04-23T08:31:17.283Z</updated>
    
    <content type="html"><![CDATA[<h3 id="django相关"><a href="#django相关" class="headerlink" title="django相关"></a>django相关</h3><ol><li><p>中间件<br>中间件一般做认证或批量请求处理，django中的中间件，其实是一个类，在请求和结束后，django会根据自己的规则在合适的时机执行中间件中相应的方法，<br>如请求过来 执行process_request, view，process_response方法</p></li><li><p>Django、Tornado、Flask各自的优势<br>Django：Django无socket，django的目的是简便，快速开发，并遵循MVC设计，多个组件可以很方便的以“插件”形式服务于整个框架，<br>django有许多功能强大的第三方插件。django具有很强的可扩展性。<br>Tornado：它是非阻塞式服务器，而且速度相当快，得力于其 非阻塞的方式和对epoll的运用，Future对象，缺点：没有session，需要自定制<br>Flask：是一个微型的web框架，配合SQLALchemy来使用，jinja2模板， werkzeug接口                  </p></li><li><p>django版本，Python版本，linux版本<br>django：1.11<br>Python：3.5<br>linux：6.8</p></li><li><p>django的template的注释是什么样子的<br>单行：<br>多行注释：&#123;%comment%&#123;&#123;</p></li><li><p>django怎么弄并发的<br>nginx+uwsig为django提供高并发，nginx的并发能力超过，单台并发能力过完，在纯静态的web服务中更是突出其优越的地方，由于底层使用epoll异步IO模型进行处理。</p></li><li><p>tornodo的ioloop知道是什么吗？<br>事件循环</p></li><li><p>select_related和prefetch_related，Q和F<br>select_related：一对多使用，查询主动做连表<br>prefetch_related：多对多或者一对多的时候使用，不做连表，做多次查询<br>Q：用于构造复杂查询条件<br>F：更新时用于获取原来的值，专门取对象中某一列进行操作</p></li><li><p>什么是ORM？<br>ORM，即Object-Relational Mapping（对象关系映射），它的作用是在关系型数据库和业务实体对象之间做一个映射<br>ORM优缺点：<br>优点：摆脱复杂的SQL操作，适应快速开发，让数据结果变得简单，数据库迁移成本更低<br>缺点：性能较差，不适用于大型应用，复杂的SQL操作还需要通过SQL语句实现</p></li><li><p>CORS跨域资源共享<br>首先会发送”预检”opption”，请求，如果”预检”成功，则发送真实数据。</p></li><li><p>Django的Form主要具有以下功能？<br>生成HTMl标签，验证用户数据 is_vaild，HTML Form提交保留上次提交数据，初始化页面显示内容</p></li><li><p>CBV和FBV<br>CBV在指定的类上面加上装饰器或在此方法上面添加装饰器 @method_decorator,并继承view</p></li><li><p>cookie及session<br>cookie：是保留在客户端上面的一组键值对，cookie不是很安全，别人可以分析存放在本地的cookie<br>session：是保存在服务器上面的一组键值对，依赖与cookie，安全指数比cookie高</p></li><li><p>django的请求生命周期<br>请求来了先到uwsgi，把请求做一部分分装给django框架，然后经过所有的中间件，路由，视图，视图处理再返回给中间件，中间件在返回给uwsgi，在返回给用户。</p></li><li><p>uwsgi和wsgi<br>wsgi：是web服务器网关接口，是pyhton应用程序或框架和web服务器之间的一种接口，其广泛使用的是django框架。<br>uwsgi：是一个web服务器，它实现了wsgi协议，Nginx中HttpUwsgiModule的作用是与Uwsgi服务器进行交换</p></li><li><p>解释下django - debug -toolbar的使用<br>使用django开发站点时，可以使用django-debug-toolbar来进行调试，在settings.py中添加 ‘debug—toolbar.midleware.Debug ToolbarMiddleware’到项目的MIDDLEWARE_CLASSES内。</p></li></ol><h3 id="Python部分"><a href="#Python部分" class="headerlink" title="Python部分"></a>Python部分</h3><ol><li><p><strong>new</strong>.<strong>init</strong>区别，如何实现单例模式，有什么优点<br><strong>new</strong>是一个静态方法，<strong>init</strong>是一个实例方法<br><strong>new</strong>返回一个创建的实例，<strong>init</strong>什么都不返回<br><strong>new</strong>返回一个cls的实例时后面的<strong>init</strong>才能被调用<br>当创建一个新实例时调用<strong>new</strong>，初始化一个实例时调用<strong>init</strong></p></li><li><p>深浅拷贝<br>浅拷贝只是增加了一个指针指向一个存在的地址，而深拷贝是增加一个指针并且开辟了新的内存，这个增加的指针指向这个新的内存，<br>采用浅拷贝的情况，释放内存，会释放同一内存，深拷贝就不会出现释放同一内存的错误</p></li><li><p>HTTP/IP相关协议，分别位于哪层<br>http协议是超文本传输协议，http协议是基于TCP/IP通信协议来传递数据<br>http协议工作与c/s架构上，浏览器作为http的客户端通过URL向http服务端即web服务器发送所用请求。web服务器收到所有请求后，向客户端发送响应信息，<br>http特点是短连接，无状态<br>地址栏键输入URL，按下回车之后经历了什么？</p></li><li><p>浏览器向DNS服务器请求解析该URL中的域名所对应的IP地址</p></li><li><p>解析出IP地址后，根据IP地址和默认端口80，和服务器建立TCP连接</p></li><li><p>浏览器发出读取文件的http请求，该请求报文作为TCP三次握手的第三个报文的数据发送给服务器</p></li><li><p>服务器对浏览器请求做出响应，并把对应的html文件发送给浏览器</p></li><li><p>释放TCP连接</p></li><li><p>浏览器将该HMTL渲染并显示内容</p></li><li><p>TCP/UDP区别<br>TCP协议是面向连接，保证高可靠性（数据无丢失，数据无失序，数据无错误，数据无重复达到）传输层协议<br>UDP：数据丢失，无秩序的传输层协议（qq基于udp协议）</p></li><li><p>webscoket<br>websocket是基于http协议的，可持续化连接<br>轮询：浏览器每隔几秒就发送一次请求，询问服务器是否有新消息<br>长轮询：客户端发起连接后，如果没有消息，就一直不返回response给客户端，直到有消息返回，返回完之后，客户端再次发起连接</p></li><li><p>RabbitMQ:<br>服务器端有Erlang语言来编写，支持多种客户端，只会ajax，用于分布式系统中存储转发消息，在易用性、扩展性、高可用性的方面不俗。<br>connection是RabbitMQ的socket连接，它封装了socket部分相关协议逻辑<br>connectionFactroy为connection的制造工厂<br>channel是我们与RabbitMQ打交道的最重要的一个接口，大部分的业务操作是在chaanel这个接口中完成，包括定义Queue、定义Exchange、<br>绑定Queue与Exchange,发布消息等</p></li><li><p>装饰器<br>调用装饰器其实是一个闭包函数，为其他函数添加附加功能，不修改被修改的源代码和不修改被修饰的方式，装饰器的返回值也是一个函数对象。<br>比如：插入日志、性能测试、事物处理、缓存、权限验证等，有了装饰器，就可以抽离出大量与函数功能本身无关的雷同代码并继续重用。</p></li><li><p>闭包</p></li><li><p>必须有一个内嵌函数</p></li><li><p>内嵌函数必须引用外部函数的变量（该函数包含对外作用域而不是全局作用域名字的引用）</p></li><li><p>外部函数的返回值必须是内嵌函数</p></li><li><p>迭代器与生成器<br>迭代可迭代对象对应_iter_（方法）和迭代器对应_next_（方法）的一个过程<br>生成器：包括含有yield这个关键字，生成器也是迭代器，调动next把函数变成迭代器。</p></li><li><p>classmethod，staticmethod，property<br>类方法：将类的函数转换成类方法，函数上装饰@classmethod会将函数的自动传值参数改成cls<br>静态方法：此方法相当于给类扩展一个功能，将类内的函数实例化，给类或对象使用，此时类内的函数就是普通函数，不管是类还是实例化的对象都可以使用<br>实例化：类的实例化就会产生一个实例（对象），可以理解为类（）把虚拟的东西实例化，得到具体存在的值</p></li><li><p>常用的状态码<br>200–服务器成功返回网页<br>204–请求收到,但返回信息为空<br>304–客户端已经执行了GET,但文件未变化<br>400–错误请求，如语法错误<br>403–无权限访问<br>404–请求的页面不存在<br>500–服务器产生内部错误<br>‍</p></li><li><p>多进程，多线程，协程，GIL<br>GIL:全局解释器锁，是锁在cpython解释器上，导致同一时刻，同一进程只能有一个线程被执行<br>多进程：多进程模块multiprocessing来实现，cpu密集型，IO计算型可以用多进程<br>多线程：多线程模块threading来实现，IO密集型，多线程可以提高效率<br>协程：依赖于geenlet，对于多线程应用。cpu通过切片的方式来切换线程间的执行，遇到IO操作自动切换，线程切换时需要耗时，<br>而协成好处没有切换的消耗，没有锁定概念。<br>进程：是资源管理单位，进行是相互独立的，实现并发和并发<br>线程：是最小的执行单位，线程的出现为了降低上下文切换的消耗，提供系统的并发性</p></li><li><p>IO多路复用/异步非阻塞<br>IO多路复用：通过一种机制，可以监听多个描述符 select/poll/epoll<br>select：连接数受限，查找配对速度慢，数据由内核拷贝到用户态<br>poll：改善了连接数，但是还是查找配对速度慢，数据由内核拷贝到用户态<br>epoll：epoll是linux下多路复用IO接口，是select/poll的增强版，它能显著提高程序在大量并发连接中只有少量活跃的情况下的系统CPU利用率<br>异步非阻塞：异步体现在回调上，回调就是有消息返回时告知一声儿进程进行处理。非阻塞就是不等待，不需要进程等待下去，<br>继续执行其他操作，不管其他进程的状态。</p></li><li><p>PEP8规范，规范的好处是什么？</p></li><li><p>缩进：4个空实现缩进，尽量不使用Tab</p></li><li><p>行：没行最大长度不超过79，换行可以使用反斜杠</p></li><li><p>命名规范：</p></li><li><p>注释规范：</p></li><li><p>range-and-xrange<br>都在循环时使用，xrange内存性能更好，xrange用法与range完全相同，range一个生成list对象，xrange是生成器</p></li><li><p>with上下文机制原理<br>_enter_和_exit_，上下文管理协议，即with语句，为了让一个对象兼容with语句，必须在这个对象类中声明_enter_和_exit_方法，<br>使用with语句的目的就是把代码块放入with中执行，with结束后，自动完成清理工作，无须收到干预</p></li><li><p>经典类、新式类<br>经典类遵循：深度优先，python2中<br>新式类遵循：广度优先，Python3中</p></li><li><p>有没有一个工具可以帮助查找Python的bug和进行静态的代码分析？<br>PyChecker是一个Python代码的静态分析工具，它可以帮助查找Python代码的bug，会对代码的复杂度和格式提出警告，<br>Pylint是另外一个工具可以进行codingstandard检查  </p></li><li><p>Python是如何进行内存管理的</p></li><li><p>对象引用计数：<br>  引用计数增加的情况：<br>  来保持追踪内存中的对象，所有对象都用引用计数，一个对象分配一个新名称<br>  将其放入一个容器中（列表，字典，元祖）<br>  引用计数减少的情况：<br>  使用del语句对对象别名显示的销毁<br>  引用超出作用域或被重新赋值<br>  sys.getrefcount()函数可以获得对象的当前引用计数</p></li><li><p>标记-清除机制</p></li><li><p>分代技术</p></li><li><p>什么是python？使用python有什么好处？<br>python是一种编程语言，它有对象、模块、线程、异常处理和自动内存管理。它简洁，简单、方便、容易扩展、有许多自带的数据结果，而且它开源</p></li><li><p>什么是pickling和unpickling？<br>Pickle模块读入任何python对象，将它们转换成字符串，然后使用dump函数将其转储到一个文件中——这个过程叫做pickling<br>反之从存储的字符串文件中提取原始python对象的过程，叫做unpickling</p></li><li><p>python是如何被解释的？<br>Python是一种解释性语言，它的源代码可以直接运行，Python解释器会将源代码转换成中间语言，之后再翻译成机器码再执行</p></li><li><p>数组和元祖之间的区别是什么？<br>数组和元祖之间的区别：数组内容可以被修改，而元祖内容是只读的，不可被修改的，另外元祖可以被哈希，比如作为字典的key</p></li><li><p>参数按值传递和引用传递是怎么实现的？<br>python中的一切都是类，所有的变量都是一个对象的引用。引用的值是由函数确定的，因此无法被改变，但是如果一个对象是可以被修改的，你可以改动对象</p></li><li><p>Python都有哪些自带的数据结构？<br>Python自带的数据结构分为可变和不可变的：可变的有：数组、集合、字典，不可变的是：字符串、元祖、整数</p></li><li><p>什么是python的命名空间？<br>在python中，所有的名字都存在于一个空间中，它们在改空间中存在和被操作——这就是命名空间，它就好像一个盒子，在每个变量名字都对应装着一个对象，<br>当查询变量的时候，会从该盒子里面寻找相应的对象</p></li><li><p>python中的unittest是什么？<br>在python中，unittest是python中的单元测试框架，它拥有支持共享搭建、自动测试、在测试中暂停代码、将不同测试迭代成一组</p></li><li><p><em>args与*</em>kwargs</p></li></ol><p><em>args代表位置参数，它会接收任意多个参数并把这些参数作为元祖传递给函数。*</em>kwargs代表的关键字参数，返回的是字典，位置参数一定要放在关键字前面</p><ol start="29"><li><p>在Python中什么是slicing？<br>slicing是一种在有序的对象类型中（数组、元祖、字符串）节选某一段的语法</p></li><li><p>中的docstring是什么？<br>Python中文档字符串被称为docstring，它在Python中的作用是为函数、模块和类注释生成文档</p></li><li><p>os与sys区别：<br>os是模块负责程序与操作系统的交互，提供了访问操作系统底层的接口<br>sys模块是负责程序与python解释器的交互，提供了一系列的函数和变量，用于操控Python时运行的环境</p></li><li><p>实现一个单例模式<br>_new_（）在 _init_（）之前被调用，用于生成实例对象。利用这个方法和类的属性的特点可以实现设计模式的单例模式。<br>单例模式是指创建唯一对象，单例模式设计的类只能实例，实例化1个对象</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class Singleton(object):</span><br><span class="line">    __instance&#x3D;None</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line">    def __new__(cls, *args, **kwargs):</span><br><span class="line">        if Singleton.__instance is None:</span><br><span class="line">            Singleton.__instance&#x3D;object.__new__(cls,*args,**kwargs)</span><br><span class="line">        return Singleton.__instance</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      一些python相关的知识点整理
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>面向对象-使用枚举类</title>
    <link href="https://shuke163.github.io/2020/04/23/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE%E7%B1%BB/"/>
    <id>https://shuke163.github.io/2020/04/23/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE%E7%B1%BB/</id>
    <published>2020-04-23T08:23:06.000Z</published>
    <updated>2020-04-23T08:23:22.596Z</updated>
    
    <content type="html"><![CDATA[<h2 id="面向对象-使用枚举类"><a href="#面向对象-使用枚举类" class="headerlink" title="面向对象-使用枚举类"></a>面向对象-使用枚举类</h2><p>当我们需要定义常量时，一个办法是用大写变量通过整数来定义，例如月份：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JAN &#x3D; 1</span><br><span class="line">FEB &#x3D; 2</span><br><span class="line">MAR &#x3D; 3</span><br><span class="line">...</span><br><span class="line">NOV &#x3D; 11</span><br><span class="line">DEC &#x3D; 12</span><br></pre></td></tr></table></figure><p>好处是简单，缺点是类型是int，并且仍然是变量。</p><p>更好的方法是为这样的枚举类型定义一个class类型，然后，每个常量都是class的一个唯一实例。Python提供了Enum类来实现这个功能：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from enum import Enum</span><br><span class="line"></span><br><span class="line">Month &#x3D; Enum(&#39;Month&#39;, (&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;, &#39;May&#39;, &#39;Jun&#39;, &#39;Jul&#39;, &#39;Aug&#39;, &#39;Sep&#39;, &#39;Oct&#39;, &#39;Nov&#39;, &#39;Dec&#39;))</span><br></pre></td></tr></table></figure><p>这样我们就获得了Month类型的枚举类，可以直接使用Month.Jan来引用一个常量，或者枚举它的所有成员：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for name, member in Month.__members__.items():</span><br><span class="line">    print(name, &#39;&#x3D;&gt;&#39;, member, &#39;,&#39;, member.value)</span><br></pre></td></tr></table></figure><p>value属性则是自动赋给成员的int常量，默认从1开始计数。</p><p>如果需要更精确地控制枚举类型，可以从Enum派生出自定义类：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from enum import Enum, unique</span><br><span class="line"></span><br><span class="line">@unique</span><br><span class="line">class Weekday(Enum):</span><br><span class="line">    Sun &#x3D; 0 # Sun的value被设定为0</span><br><span class="line">    Mon &#x3D; 1</span><br><span class="line">    Tue &#x3D; 2</span><br><span class="line">    Wed &#x3D; 3</span><br><span class="line">    Thu &#x3D; 4</span><br><span class="line">    Fri &#x3D; 5</span><br><span class="line">    Sat &#x3D; 6</span><br></pre></td></tr></table></figure><p>@unique装饰器可以帮助我们检查保证没有重复值。</p><p>访问这些枚举类型可以有若干种方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; day1 &#x3D; Weekday.Mon</span><br><span class="line">&gt;&gt;&gt; print(day1)</span><br><span class="line">Weekday.Mon</span><br><span class="line">&gt;&gt;&gt; print(Weekday.Tue)</span><br><span class="line">Weekday.Tue</span><br><span class="line">&gt;&gt;&gt; print(Weekday[&#39;Tue&#39;])</span><br><span class="line">Weekday.Tue</span><br><span class="line">&gt;&gt;&gt; print(Weekday.Tue.value)</span><br><span class="line">2</span><br><span class="line">&gt;&gt;&gt; print(day1 &#x3D;&#x3D; Weekday.Mon)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; print(day1 &#x3D;&#x3D; Weekday.Tue)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; print(Weekday(1))</span><br><span class="line">Weekday.Mon</span><br><span class="line">&gt;&gt;&gt; print(day1 &#x3D;&#x3D; Weekday(1))</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; Weekday(7)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  ...</span><br><span class="line">ValueError: 7 is not a valid Weekday</span><br><span class="line">&gt;&gt;&gt; for name, member in Weekday.__members__.items():</span><br><span class="line">...     print(name, &#39;&#x3D;&gt;&#39;, member)</span><br><span class="line">...</span><br><span class="line">Sun &#x3D;&gt; Weekday.Sun</span><br><span class="line">Mon &#x3D;&gt; Weekday.Mon</span><br><span class="line">Tue &#x3D;&gt; Weekday.Tue</span><br><span class="line">Wed &#x3D;&gt; Weekday.Wed</span><br><span class="line">Thu &#x3D;&gt; Weekday.Thu</span><br><span class="line">Fri &#x3D;&gt; Weekday.Fri</span><br><span class="line">Sat &#x3D;&gt; Weekday.Sat</span><br></pre></td></tr></table></figure><p>可见，既可以用成员名称引用枚举常量，又可以直接根据value的值获得枚举常量。</p><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>把Student的gender属性改造为枚举类型，可以避免使用字符串：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line">from enum import Enum, unique</span><br><span class="line"></span><br><span class="line">class Gender(Enum):</span><br><span class="line">    Male &#x3D; 0</span><br><span class="line">    Female &#x3D; 1</span><br><span class="line"></span><br><span class="line">class Student(object):</span><br><span class="line">    def __init__(self, name, gender):</span><br><span class="line">        self.name &#x3D; name</span><br><span class="line">        self.gender &#x3D; gender</span><br><span class="line"># 测试:</span><br><span class="line">bart &#x3D; Student(&#39;Bart&#39;, Gender.Male)</span><br><span class="line">if bart.gender &#x3D;&#x3D; Gender.Male:</span><br><span class="line">    print(bart.gender.value)</span><br><span class="line">    print(&#39;测试通过!&#39;)</span><br><span class="line">else:</span><br><span class="line">    print(&#39;测试失败!&#39;)</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>Enum</code>可以把一组相关常量定义在一个class中，且class不可变，而且成员可以直接比较。</p><p><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191235886950998592cd3e426e91687cdae696e64b000" target="_blank" rel="noopener">原文地址</a></p>]]></content>
    
    <summary type="html">
    
      面向对象-使用枚举类
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>深入类与对象-上下文管理器</title>
    <link href="https://shuke163.github.io/2020/04/23/%E6%B7%B1%E5%85%A5%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1-%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/"/>
    <id>https://shuke163.github.io/2020/04/23/%E6%B7%B1%E5%85%A5%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1-%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8/</id>
    <published>2020-04-23T08:19:17.000Z</published>
    <updated>2020-04-23T08:20:48.980Z</updated>
    
    <content type="html"><![CDATA[<h2 id="深入类与对象-上下文管理器"><a href="#深入类与对象-上下文管理器" class="headerlink" title="深入类与对象-上下文管理器"></a>深入类与对象-上下文管理器</h2><h3 id="mixin继承"><a href="#mixin继承" class="headerlink" title="mixin继承"></a>mixin继承</h3><p>多继承会造成关系混乱，导致MRO算法出现许多预料不到的问题，一般都是推荐MIXIN继承，最小继承，只继承一个类。</p><h3 id="上下文管理器"><a href="#上下文管理器" class="headerlink" title="上下文管理器"></a>上下文管理器</h3><p>with上下文管理器，这个用过很多次，比如在执行mysql语句的时候要先链接数据库，获取游标，执行sql语句，关闭连接。又或者是文本内容的读写，打开文本写入内容关闭文本。</p><p>如果每次执行一条语句都要做这么多操作，就会产生大量重复的代码，这个时候使用上下文管理器即可美观又轻松的解决这个问题。</p><p>with管理上下文的作用是对一些重复的代码简单化，并且能优化try/except/finally的写法。</p><p>上下文的实现是通过两个魔法函数enter和exit实现，后来更新再造后，使用contextlib提供的API可以更加方便的完成。</p><p>概念和功能都明白后，最重要的还是如何实现。</p><p>举个例子：shuke去给猫买饼干，每次买的时候都要做这些动作，掏出钱包，花出x元，收回钱包。每次都要重复掏钱包收钱包这个动作有些麻烦，并且万一忘了掏钱包就不能付钱，忘了收钱包的话，钱包就掉了。每次掏钱包收钱包都要写代码，有啥简介的方式嘛？</p><h3 id="使用enter和exit实现-1"><a href="#使用enter和exit实现-1" class="headerlink" title="使用enter和exit实现(1)"></a>使用enter和exit实现(1)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#! &#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">@author: shuke</span><br><span class="line">@file: 0325.py </span><br><span class="line">@time: 2019&#x2F;03&#x2F;25 16:28</span><br><span class="line">@contact: zhaofengfeng@shuke.net</span><br><span class="line">@software:  learn</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class wallet(object):</span><br><span class="line">    def __init__(self, man):</span><br><span class="line">        self.man &#x3D; man</span><br><span class="line"></span><br><span class="line">    def __enter__(self):</span><br><span class="line">        print(self.man + &#39;放心大胆的掏出了钱包&#39;)</span><br><span class="line"></span><br><span class="line">    def __exit__(self, exc_type, exc_val, exc_tb):</span><br><span class="line">        print(self.man + &#39;小心翼翼的收起来钱包&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def use_money(man):</span><br><span class="line">    return wallet(man)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with use_money(&#39;shuke&#39;) as a:</span><br><span class="line">    print(&#39;花了600块钱&#39;)</span><br></pre></td></tr></table></figure><p>返回结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shuke放心大胆的掏出了钱包</span><br><span class="line">花了600块钱</span><br><span class="line">shuke小心翼翼的收起来钱包</span><br></pre></td></tr></table></figure><h3 id="使用enter和exit实现-2"><a href="#使用enter和exit实现-2" class="headerlink" title="使用enter和exit实现(2)"></a>使用enter和exit实现(2)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class wallet(object):</span><br><span class="line">    def __init__(self, man):</span><br><span class="line">        self.man &#x3D; man</span><br><span class="line"></span><br><span class="line">    def __enter__(self):</span><br><span class="line">        print(self.man + &#39;放心大胆的掏出了钱包&#39;)</span><br><span class="line">        # return self 这一步非常重要，作用是返回实例</span><br><span class="line">        return self</span><br><span class="line"></span><br><span class="line">    def __exit__(self, exc_type, exc_val, exc_tb):</span><br><span class="line">        print(self.man + &#39;小心翼翼的收起来钱包&#39;)</span><br><span class="line"></span><br><span class="line">    def use_money(self, money):</span><br><span class="line">        print(self.man + &#39;花了&#39; + money + &#39;元&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with wallet(&#39;shuke02&#39;)as a:</span><br><span class="line">    a.use_money(&#39;1000&#39;)</span><br></pre></td></tr></table></figure><p>运行结果:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shuke02放心大胆的掏出了钱包</span><br><span class="line">shuke02花了1000元</span><br><span class="line">shuke02小心翼翼的收起来钱包</span><br></pre></td></tr></table></figure><h3 id="使用contextlib实现"><a href="#使用contextlib实现" class="headerlink" title="使用contextlib实现"></a>使用contextlib实现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import contextlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@contextlib.contextmanager</span><br><span class="line">def use_money(man):</span><br><span class="line">    try:</span><br><span class="line">        print(man + &#39;十分放心大胆的掏出钱包&#39;)</span><br><span class="line">        yield None</span><br><span class="line">        # yield生成器，运行到这里会返回一个值(你随便写一个就行)</span><br><span class="line">    finally:</span><br><span class="line">        print(man + &#39;万分谨慎的收起了钱包&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with use_money(&#39;shuke03&#39;)as a:</span><br><span class="line">    print(&#39;花了100块钱&#39;)</span><br></pre></td></tr></table></figure><p>返回结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shuke03十分放心大胆的掏出钱包</span><br><span class="line">花了100块钱</span><br><span class="line">shuke03万分谨慎的收起了钱包</span><br></pre></td></tr></table></figure><p>这只是一个创建上下文管理器的方法，按照固定的格式书写就行.</p><h3 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h3><p><a href="http://www.langzi.fun/%E6%B7%B1%E5%85%A5%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1-%E4%B8%8B.html" target="_blank" rel="noopener">深入类与对象-下</a></p>]]></content>
    
    <summary type="html">
    
      深入类与对象-上下文管理器
    
    </summary>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/categories/PYTHON/"/>
    
    
      <category term="PYTHON" scheme="https://shuke163.github.io/tags/PYTHON/"/>
    
  </entry>
  
  <entry>
    <title>给大家安利几个 Flask 学习资源</title>
    <link href="https://shuke163.github.io/2020/04/23/%E7%BB%99%E5%A4%A7%E5%AE%B6%E5%AE%89%E5%88%A9%E5%87%A0%E4%B8%AA-Flask-%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90/"/>
    <id>https://shuke163.github.io/2020/04/23/%E7%BB%99%E5%A4%A7%E5%AE%B6%E5%AE%89%E5%88%A9%E5%87%A0%E4%B8%AA-Flask-%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90/</id>
    <published>2020-04-23T08:17:58.000Z</published>
    <updated>2020-04-23T08:44:25.146Z</updated>
    
    <content type="html"><![CDATA[<h2 id="给大家安利几个-Flask-学习资源"><a href="#给大家安利几个-Flask-学习资源" class="headerlink" title="给大家安利几个 Flask 学习资源"></a>给大家安利几个 Flask 学习资源</h2><p>Flask 是 Python 中最流行的 Web 框架之一，以小巧、灵活、可扩展性强著称，相比 Django，它给了开发者最大限度的自由，如果你不喜欢关系型数据库，ok，没问题，切换成本非常低，而 Django 呢？你能遇到的问题它都帮你想好并且提供了对应解决方案，你自己就不要去重复造轮子了，比如模版引擎，ORM，不爽想替换？这个有点难。</p><h3 id="1-The-Flask-Mega-Tutorial-教程"><a href="#1-The-Flask-Mega-Tutorial-教程" class="headerlink" title="1. The Flask Mega-Tutorial 教程"></a>1. The Flask Mega-Tutorial 教程</h3><p>这个教程是《Flask Web开发：基于Python的Web应用开发实战》作者 Miguel Grinberg 写的 2017版 Flask 教程，也是我强烈推荐给大家的 Flask 教程，英语阅读水平过得去的话，建议直接读原文，英语渣也有福音，国内已有网友把它翻译成了中文。</p><p><a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world" target="_blank" rel="noopener">英文地址</a><br><a href="https://github.com/luhuisicnu/The-Flask-Mega-Tutorial-zh" target="_blank" rel="noopener">中文地址</a></p><h3 id="2-Flask之旅"><a href="#2-Flask之旅" class="headerlink" title="2. Flask之旅"></a>2. Flask之旅</h3><p>如果你已经入门了Flask，肯定希望有一个 Flask 最佳实践指南，让你的 Flask 项目看起来更加 professional，而本书涉及的主题就是Flask的最佳编程实践和模式。尽量避免啰嗦官方文档中提到的内容，同时也会再次强调一些概念来加深印象。</p><p><a href="http://exploreflask.com/en/latest/" target="_blank" rel="noopener">英文地址</a><br><a href="https://spacewander.github.io/explore-flask-zh/index.html" target="_blank" rel="noopener">中文地址</a></p><h3 id="3-Flask-源码解析"><a href="#3-Flask-源码解析" class="headerlink" title="3. Flask 源码解析"></a>3. Flask 源码解析</h3><p>如果你已经熟练掌握了 Flask 框架，是不是惊叹于 Flask 框架背后的设计精髓，一个精悍的Web框架究竟是如何实现的？了解它最好的办法就是窥探它的源码，还好，这件事已经有人帮你做了。</p><p><a href="http://cizixs.com/2017/01/13/flask-insight-context" target="_blank" rel="noopener">地址</a></p><h3 id="4-Awesome-Flask"><a href="#4-Awesome-Flask" class="headerlink" title="4. Awesome Flask"></a>4. Awesome Flask</h3><p>最后强烈推荐的是这个 Awesome 系列的 Flask 资源大集合，涵盖了 Flask 的各方各面，包括第三方扩展插件以及教程、书籍和视频、PPT还有项目结构等等。</p><p><a href="https://github.com/humiaozuzu/awesome-flask" target="_blank" rel="noopener">地址</a></p><h3 id="5-Flask-for-Fun-and-Profit"><a href="#5-Flask-for-Fun-and-Profit" class="headerlink" title="5. Flask for Fun and Profit"></a>5. Flask for Fun and Profit</h3><p>Flask 作者 Armin Ronacher 在PyBay2016上的一个视频分享，手把手教你如何构建一个大型复杂的易于测试的API服务。同时还有在开发Flask的过程的一些设计思想。</p><p><a href="https://www.youtube.com/watch?v=1ByQhAM5c1I" target="_blank" rel="noopener">视频地址</a><br><a href="https://speakerdeck.com/player/94a53afb6a524ad88f301f62166a27e4?" target="_blank" rel="noopener">PPT</a></p><h3 id="再补充一些其它资源："><a href="#再补充一些其它资源：" class="headerlink" title="再补充一些其它资源："></a>再补充一些其它资源：</h3><p>Flask Web 开发入门<br><a href="https://funhacks.gitbooks.io/head-first-flask/content/chapter02/section2.03.html" target="_blank" rel="noopener">https://funhacks.gitbooks.io/head-first-flask/content/chapter02/section2.03.html</a></p><p><a href="http://www.bjhee.com/flask-1.html" target="_blank" rel="noopener">Flask入门系列教程</a></p><p><a href="http://www.bjhee.com/flask-ad1.html" target="_blank" rel="noopener">Flask进阶系列教程</a></p><p>Full Stack Web Development with Flask (视频教程，需要翻土啬)<br><a href="https://github.com/realpython/discover-flask" target="_blank" rel="noopener">https://github.com/realpython/discover-flask</a></p><p>Full Stack Python<br><a href="https://www.fullstackpython.com/flask.html" target="_blank" rel="noopener">https://www.fullstackpython.com/flask.html</a></p>]]></content>
    
    <summary type="html">
    
      给大家安利几个 Flask 学习资源
    
    </summary>
    
    
      <category term="Flask" scheme="https://shuke163.github.io/categories/Flask/"/>
    
    
      <category term="Flask" scheme="https://shuke163.github.io/tags/Flask/"/>
    
  </entry>
  
  <entry>
    <title>zabbix使用python获取阿里云SLB带宽</title>
    <link href="https://shuke163.github.io/2020/04/23/zabbix%E4%BD%BF%E7%94%A8python%E8%8E%B7%E5%8F%96%E9%98%BF%E9%87%8C%E4%BA%91SLB%E5%B8%A6%E5%AE%BD/"/>
    <id>https://shuke163.github.io/2020/04/23/zabbix%E4%BD%BF%E7%94%A8python%E8%8E%B7%E5%8F%96%E9%98%BF%E9%87%8C%E4%BA%91SLB%E5%B8%A6%E5%AE%BD/</id>
    <published>2020-04-23T08:16:12.000Z</published>
    <updated>2020-04-23T08:16:23.469Z</updated>
    
    <content type="html"><![CDATA[<h2 id="zabbix使用python获取阿里云SLB带宽"><a href="#zabbix使用python获取阿里云SLB带宽" class="headerlink" title="zabbix使用python获取阿里云SLB带宽"></a>zabbix使用python获取阿里云SLB带宽</h2><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/qgRAExPhngfpWON9icxJarejKzj940jmKeg9B7m6hgribxIaWtbYNsndFU2NVpxOIVr9oZAT7Phn93Zulicjnladw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="展示图"></p><h3 id="阿里云SDK"><a href="#阿里云SDK" class="headerlink" title="阿里云SDK"></a>阿里云SDK</h3><p>阿里云目前提供了很多的SDK，并且可以使用在线调试工具，虽然有些bug</p><p><a href="https://develop.aliyun.com/tools/sdk?#/python" target="_blank" rel="noopener">Python-sdk</a></p><p><a href="https://api.aliyun.com/?spm=5176.143622.743215.5.524c6168naUyOU" target="_blank" rel="noopener">在线调试工具</a></p><p>但是主页面的SDK列表里面并没有SLB，并且翻了下aliyun-python-sdk-slb (2.1.2)这个包里面好像也没有带宽相关的描述。别急，我们还有云监控的SDK。</p><p>这里我们使用了阿里云云监控的SDK（aliyun-python-sdk-cms (5.0.0)）</p><p>获取SLB带宽<br>Python2.7调试通过，需要使用pip安装<code>liyun-python-sdk-core，aliyun-python-sdk-cms</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"></span><br><span class="line">#coding&#x3D;utf-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">from aliyunsdkcore import client</span><br><span class="line"></span><br><span class="line">from aliyunsdkcms.request.v20170301 import QueryMetricListRequest</span><br><span class="line"></span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">clt &#x3D; client.AcsClient(&#39;&lt;ACCESSKEY&gt;&#39;,&#39;&lt;SECRETKEY&gt;&#39;,&#39;cn-beijing&#39;)</span><br><span class="line"></span><br><span class="line">request &#x3D; QueryMetricListRequest.QueryMetricListRequest()</span><br><span class="line"></span><br><span class="line">request.set_accept_format(&#39;json&#39;)</span><br><span class="line"></span><br><span class="line">#两个参数按照预设值设定，参见参考资料描述</span><br><span class="line"></span><br><span class="line">request.set_Project(&#39;acs_slb&#39;)</span><br><span class="line"></span><br><span class="line">request.set_Metric(&#39;TrafficTXNew&#39;)</span><br><span class="line"></span><br><span class="line">#只获取1小时内的数据</span><br><span class="line"></span><br><span class="line">start_time &#x3D; time.strftime(&#39;%Y-%m-%d %H:%M:%S&#39;,time.localtime(time.time()-3600))</span><br><span class="line"></span><br><span class="line">timestamp_start &#x3D; int(time.mktime(time.strptime(start_time, &quot;%Y-%m-%d %H:%M:%S&quot;))) * 1000</span><br><span class="line"></span><br><span class="line">request.set_StartTime(timestamp_start)</span><br><span class="line"></span><br><span class="line">#从系统输入参数获取IP地址和SLB-ID</span><br><span class="line"></span><br><span class="line">slbip &#x3D; sys.argv[1]</span><br><span class="line"></span><br><span class="line">slbid &#x3D; sys.argv[2]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">request.set_Dimensions(&#123;&#39;instanceId&#39;:slbid,&#39;port&#39;:&#39;443&#39;,&#39;vip&#39;:slbip&#125;)</span><br><span class="line"></span><br><span class="line">request.set_Period(&#39;60&#39;)</span><br><span class="line"></span><br><span class="line">#result &#x3D; clt.do_action(request)</span><br><span class="line"></span><br><span class="line">result &#x3D; clt.do_action_with_exception(request)</span><br><span class="line"></span><br><span class="line">#print result</span><br><span class="line"></span><br><span class="line">#json结果处理</span><br><span class="line"></span><br><span class="line">datadict &#x3D; json.loads(result)</span><br><span class="line"></span><br><span class="line">#取倒数第二条数据，因为倒数第一条不太准</span><br><span class="line"></span><br><span class="line">res &#x3D; datadict[&#39;Datapoints&#39;][-2][&#39;Average&#39;]</span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure><p>使用方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python ali-slb.py  &lt;IP地址&gt;  &lt;SLB的ID&gt;</span><br></pre></td></tr></table></figure><p>然后接入zabbix，使用grafana就可以出图了。</p>]]></content>
    
    <summary type="html">
    
      zabbix使用python获取阿里云SLB带宽
    
    </summary>
    
    
      <category term="Zabbix" scheme="https://shuke163.github.io/categories/Zabbix/"/>
    
    
      <category term="Zabbix" scheme="https://shuke163.github.io/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>Vim命令合集</title>
    <link href="https://shuke163.github.io/2020/04/23/Vim%E5%91%BD%E4%BB%A4%E5%90%88%E9%9B%86/"/>
    <id>https://shuke163.github.io/2020/04/23/Vim%E5%91%BD%E4%BB%A4%E5%90%88%E9%9B%86/</id>
    <published>2020-04-23T08:15:47.000Z</published>
    <updated>2020-04-23T08:15:57.548Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Vim命令合集"><a href="#Vim命令合集" class="headerlink" title="Vim命令合集"></a>Vim命令合集</h2><h3 id="命令历史"><a href="#命令历史" class="headerlink" title="命令历史"></a>命令历史</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以:和&#x2F;开头的命令都有历史纪录，可以首先键入:或&#x2F;然后按上下箭头来选择某个历史命令。</span><br></pre></td></tr></table></figure><h3 id="启动vim"><a href="#启动vim" class="headerlink" title="启动vim"></a>启动vim</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在命令行窗口中输入以下命令即可</span><br><span class="line"></span><br><span class="line">vim 直接启动vim</span><br><span class="line"></span><br><span class="line">vim filename 打开vim并创建名为filename的文件</span><br></pre></td></tr></table></figure><h3 id="文件命令"><a href="#文件命令" class="headerlink" title="文件命令"></a>文件命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">打开单个文件</span><br><span class="line">vim file</span><br><span class="line"></span><br><span class="line">同时打开多个文件</span><br><span class="line">vim file1 file2 file3 …</span><br><span class="line"></span><br><span class="line">在vim窗口中打开一个新文件</span><br><span class="line">:open file</span><br><span class="line"></span><br><span class="line">在新窗口中打开文件</span><br><span class="line">:split file</span><br><span class="line"></span><br><span class="line">切换到下一个文件</span><br><span class="line">:bn</span><br><span class="line"></span><br><span class="line">切换到上一个文件</span><br><span class="line">:bp</span><br><span class="line"></span><br><span class="line">查看当前打开的文件列表，当前正在编辑的文件会用[]括起来。</span><br><span class="line">:args</span><br><span class="line"></span><br><span class="line">### 打开远程文件，比如ftp或者share folder</span><br><span class="line">:e ftp:&#x2F;&#x2F;192.168.10.76&#x2F;abc.txt</span><br><span class="line">:e \\qadrive\test\1.txt</span><br></pre></td></tr></table></figure><h3 id="vim的模式"><a href="#vim的模式" class="headerlink" title="vim的模式"></a>vim的模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">正常模式（按Esc或Ctrl+[进入） 左下角显示文件名或为空</span><br><span class="line"></span><br><span class="line">插入模式（按i键进入） 左下角显示–INSERT–</span><br><span class="line"></span><br><span class="line">可视模式（不知道如何进入） 左下角显示–VISUAL–</span><br></pre></td></tr></table></figure><h3 id="导航命令"><a href="#导航命令" class="headerlink" title="导航命令"></a>导航命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% 括号匹配</span><br></pre></td></tr></table></figure><h3 id="插入命令"><a href="#插入命令" class="headerlink" title="插入命令"></a>插入命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">i 在当前位置生前插入</span><br><span class="line"></span><br><span class="line">I 在当前行首插入</span><br><span class="line"></span><br><span class="line">a 在当前位置后插入</span><br><span class="line"></span><br><span class="line">A 在当前行尾插入</span><br><span class="line"></span><br><span class="line">o 在当前行之后插入一行</span><br><span class="line"></span><br><span class="line">O 在当前行之前插入一行</span><br></pre></td></tr></table></figure><h3 id="查找命令"><a href="#查找命令" class="headerlink" title="查找命令"></a>查找命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;text　　查找text，按n健查找下一个，按N健查找前一个</span><br><span class="line"></span><br><span class="line">?text　　查找text，反向查找，按n健查找下一个，按N健查找前一个。</span><br><span class="line"></span><br><span class="line">vim中有一些特殊字符在查找时需要转义　　.*[]^%&#x2F;?~$</span><br><span class="line"></span><br><span class="line">:set ignorecase　　忽略大小写的查找</span><br><span class="line"></span><br><span class="line">:set noignorecase　　不忽略大小写的查找</span><br><span class="line"></span><br><span class="line">查找很长的词，如果一个词很长，键入麻烦，可以将光标移动到该词上，按*或#键即可以该单词进行搜索，相当于&#x2F;搜索。而#命令相当于?搜索。</span><br><span class="line"></span><br><span class="line">:set hlsearch　　高亮搜索结果，所有结果都高亮显示，而不是只显示一个匹配。</span><br><span class="line">:set nohlsearch　　关闭高亮搜索显示</span><br><span class="line">:nohlsearch　　关闭当前的高亮显示，如果再次搜索或者按下n或N键，则会再次高亮。</span><br><span class="line">:set incsearch　　逐步搜索模式，对当前键入的字符进行搜索而不必等待键入完成。</span><br><span class="line">:set wrapscan　　重新搜索，在搜索到文件头或尾时，返回继续搜索，默认开启。</span><br></pre></td></tr></table></figure><h3 id="替换命令"><a href="#替换命令" class="headerlink" title="替换命令"></a>替换命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ra 将当前字符替换为a，当期字符即光标所在字符。</span><br><span class="line"></span><br><span class="line">s&#x2F;old&#x2F;new&#x2F; 用old替换new，替换当前行的第一个匹配</span><br><span class="line"></span><br><span class="line">s&#x2F;old&#x2F;new&#x2F;g 用old替换new，替换当前行的所有匹配</span><br><span class="line"></span><br><span class="line">%s&#x2F;old&#x2F;new&#x2F; 用old替换new，替换所有行的第一个匹配</span><br><span class="line"></span><br><span class="line">%s&#x2F;old&#x2F;new&#x2F;g 用old替换new，替换整个文件的所有匹配</span><br><span class="line"></span><br><span class="line">:10,20 s&#x2F;^&#x2F;    &#x2F;g 在第10行知第20行每行前面加四个空格，用于缩进。</span><br><span class="line"></span><br><span class="line">ddp 交换光标所在行和其下紧邻的一行。</span><br></pre></td></tr></table></figure><h3 id="移动命令"><a href="#移动命令" class="headerlink" title="移动命令"></a>移动命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">- h 左移一个字符</span><br><span class="line">- l 右移一个字符，这个命令很少用，一般用w代替。</span><br><span class="line">- k 上移一个字符</span><br><span class="line">- j 下移一个字符</span><br><span class="line"></span><br><span class="line">以上四个命令可以配合数字使用，比如20j就是向下移动20行，5h就是向左移动5个字符，在Vim中，很多命令都可以配合数字使用，比如删除10个字符10x，在当前位置后插入3个！，3a！&lt;Esc&gt;，这里的Esc是必须的，否则命令不生效。</span><br><span class="line"></span><br><span class="line">w 向前移动一个单词（光标停在单词首部），如果已到行尾，则转至下一行行首。此命令快，可以代替l命令。</span><br><span class="line"></span><br><span class="line">b 向后移动一个单词 2b 向后移动2个单词</span><br><span class="line"></span><br><span class="line">e，同w，只不过是光标停在单词尾部</span><br><span class="line"></span><br><span class="line">ge，同b，光标停在单词尾部。</span><br><span class="line"></span><br><span class="line">^ 移动到本行第一个非空白字符上。</span><br><span class="line"></span><br><span class="line">0（数字0）移动到本行第一个字符上，</span><br><span class="line"></span><br><span class="line">&lt;HOME&gt; 移动到本行第一个字符。同0健。</span><br><span class="line"></span><br><span class="line">$ 移动到行尾 3$ 移动到下面3行的行尾</span><br><span class="line"></span><br><span class="line">gg 移动到文件头。 &#x3D; [[</span><br><span class="line"></span><br><span class="line">G（shift + g） 移动到文件尾。 &#x3D; ]]</span><br><span class="line"></span><br><span class="line">f（find）命令也可以用于移动，fx将找到光标后第一个为x的字符，3fd将找到第三个为d的字符。</span><br><span class="line"></span><br><span class="line">F 同f，反向查找。</span><br><span class="line"></span><br><span class="line">跳到指定行，冒号+行号，回车，比如跳到240行就是 :240回车。另一个方法是行号+G，比如230G跳到230行。</span><br><span class="line"></span><br><span class="line">Ctrl + e 向下滚动一行</span><br><span class="line"></span><br><span class="line">Ctrl + y 向上滚动一行</span><br><span class="line"></span><br><span class="line">Ctrl + d 向下滚动半屏</span><br><span class="line"></span><br><span class="line">Ctrl + u 向上滚动半屏</span><br><span class="line"></span><br><span class="line">Ctrl + f 向下滚动一屏</span><br><span class="line"></span><br><span class="line">Ctrl + b 向上滚动一屏</span><br></pre></td></tr></table></figure><h3 id="撤销和重做"><a href="#撤销和重做" class="headerlink" title="撤销和重做"></a>撤销和重做</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">u 撤销（Undo）</span><br><span class="line"></span><br><span class="line">U 撤销对整行的操作</span><br><span class="line"></span><br><span class="line">Ctrl + r 重做（Redo），即撤销的撤销。</span><br></pre></td></tr></table></figure><h3 id="删除命令"><a href="#删除命令" class="headerlink" title="删除命令"></a>删除命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">x 删除当前字符</span><br><span class="line"></span><br><span class="line">3x 删除当前光标开始向后三个字符</span><br><span class="line"></span><br><span class="line">X 删除当前字符的前一个字符。X&#x3D;dh</span><br><span class="line"></span><br><span class="line">dl 删除当前字符， dl&#x3D;x</span><br><span class="line"></span><br><span class="line">dh 删除前一个字符</span><br><span class="line"></span><br><span class="line">dd 删除当前行</span><br><span class="line"></span><br><span class="line">dj 删除上一行</span><br><span class="line"></span><br><span class="line">dk 删除下一行</span><br><span class="line"></span><br><span class="line">10d 删除当前行开始的10行。</span><br><span class="line"></span><br><span class="line">D 删除当前字符至行尾。D&#x3D;d$</span><br><span class="line"></span><br><span class="line">d$ 删除当前字符之后的所有字符（本行）</span><br><span class="line"></span><br><span class="line">kdgg 删除当前行之前所有行（不包括当前行）</span><br><span class="line"></span><br><span class="line">jdG（jd shift + g）   删除当前行之后所有行（不包括当前行）</span><br><span class="line"></span><br><span class="line">:1,10d 删除1-10行</span><br><span class="line"></span><br><span class="line">:11,$d 删除11行及以后所有的行</span><br><span class="line"></span><br><span class="line">:1,$d 删除所有行</span><br><span class="line"></span><br><span class="line">J(shift + j)　　删除两行之间的空行，实际上是合并两行。</span><br></pre></td></tr></table></figure><h3 id="拷贝和粘贴"><a href="#拷贝和粘贴" class="headerlink" title="拷贝和粘贴"></a>拷贝和粘贴</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">yy 拷贝当前行</span><br><span class="line"></span><br><span class="line">nyy 拷贝当前后开始的n行，比如2yy拷贝当前行及其下一行。</span><br><span class="line"></span><br><span class="line">p  在当前光标后粘贴,如果之前使用了yy命令来复制一行，那么就在当前行的下一行粘贴。</span><br><span class="line"></span><br><span class="line">shift+p 在当前行前粘贴</span><br><span class="line"></span><br><span class="line">:1,10 co 20 将1-10行插入到第20行之后。</span><br><span class="line"></span><br><span class="line">:1,$ co $ 将整个文件复制一份并添加到文件尾部。</span><br><span class="line"></span><br><span class="line">正常模式下按v（逐字）或V（逐行）进入可视模式，然后用jklh命令移动即可选择某些行或字符，再按y即可复制</span><br><span class="line">ddp交换当前行和其下一行</span><br><span class="line"></span><br><span class="line">xp交换当前字符和其后一个字符</span><br></pre></td></tr></table></figure><h3 id="剪切命令"><a href="#剪切命令" class="headerlink" title="剪切命令"></a>剪切命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">正常模式下按v（逐字）或V（逐行）进入可视模式，然后用jklh命令移动即可选择某些行或字符，再按d即可剪切</span><br><span class="line"></span><br><span class="line">ndd 剪切当前行之后的n行。利用p命令可以对剪切的内容进行粘贴</span><br><span class="line"></span><br><span class="line">:1,10d 将1-10行剪切。利用p命令可将剪切后的内容进行粘贴。</span><br><span class="line"></span><br><span class="line">:1, 10 m 20 将第1-10行移动到第20行之后。</span><br></pre></td></tr></table></figure><h3 id="退出命令"><a href="#退出命令" class="headerlink" title="退出命令"></a>退出命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">:wq 保存并退出</span><br><span class="line"></span><br><span class="line">ZZ 保存并退出</span><br><span class="line"></span><br><span class="line">:q! 强制退出并忽略所有更改</span><br><span class="line"></span><br><span class="line">:e! 放弃所有修改，并打开原来文件。</span><br></pre></td></tr></table></figure><h3 id="窗口命令"><a href="#窗口命令" class="headerlink" title="窗口命令"></a>窗口命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:split或new 打开一个新窗口，光标停在顶层的窗口上</span><br><span class="line"></span><br><span class="line">:split file或:new file 用新窗口打开文件</span><br><span class="line"></span><br><span class="line">split打开的窗口都是横向的，使用vsplit可以纵向打开窗口。</span><br><span class="line"></span><br><span class="line">Ctrl+ww 移动到下一个窗口</span><br><span class="line"></span><br><span class="line">Ctrl+wj 移动到下方的窗口</span><br><span class="line"></span><br><span class="line">Ctrl+wk 移动到上方的窗口</span><br></pre></td></tr></table></figure><h3 id="关闭窗口"><a href="#关闭窗口" class="headerlink" title="关闭窗口"></a>关闭窗口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">:close 最后一个窗口不能使用此命令，可以防止意外退出vim。</span><br><span class="line"></span><br><span class="line">:q 如果是最后一个被关闭的窗口，那么将退出vim。</span><br><span class="line"></span><br><span class="line">ZZ 保存并退出。</span><br><span class="line"></span><br><span class="line">关闭所有窗口，只保留当前窗口</span><br><span class="line"></span><br><span class="line">:only</span><br></pre></td></tr></table></figure><h3 id="录制宏"><a href="#录制宏" class="headerlink" title="录制宏"></a>录制宏</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">按q键加任意字母开始录制，再按q键结束录制（这意味着vim中的宏不可嵌套），使用的时候@加宏名，比如qa。。。q录制名为a的宏，@a使用这个宏。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">执行shell命令</span><br><span class="line"></span><br><span class="line">:!command</span><br><span class="line"></span><br><span class="line">:!ls 列出当前目录下文件</span><br><span class="line"></span><br><span class="line">:!perl -c script.pl 检查perl脚本语法，可以不用退出vim，非常方便。</span><br><span class="line"></span><br><span class="line">:!perl script.pl 执行perl脚本，可以不用退出vim，非常方便。</span><br><span class="line"></span><br><span class="line">:suspend或Ctrl – Z 挂起vim，回到shell，按fg可以返回vim。</span><br></pre></td></tr></table></figure><h3 id="注释命令"><a href="#注释命令" class="headerlink" title="注释命令"></a>注释命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">perl程序中#开始的行为注释，所以要注释某些行，只需在行首加入#</span><br><span class="line"></span><br><span class="line">3,5 s&#x2F;^&#x2F;#&#x2F;g 注释第3-5行</span><br><span class="line"></span><br><span class="line">3,5 s&#x2F;^#&#x2F;&#x2F;g 解除3-5行的注释</span><br><span class="line"></span><br><span class="line">1,$ s&#x2F;^&#x2F;#&#x2F;g 注释整个文档。</span><br><span class="line"></span><br><span class="line">:%s&#x2F;^&#x2F;#&#x2F;g 注释整个文档，此法更快。</span><br></pre></td></tr></table></figure><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">:help or F1 显示整个帮助</span><br><span class="line"></span><br><span class="line">:help xxx 显示xxx的帮助，比如 :help i, :help CTRL-[（即Ctrl+[的帮助）。</span><br><span class="line"></span><br><span class="line">:help ‘number’ Vim选项的帮助用单引号括起</span><br><span class="line"></span><br><span class="line">:help &lt;Esc&gt;特殊键的帮助用&lt;&gt;扩起</span><br><span class="line"></span><br><span class="line">:help -t Vim启动参数的帮助用-</span><br><span class="line"></span><br><span class="line">:help i_&lt;Esc&gt; 插入模式下Esc的帮助，某个模式下的帮助用模式_主题的模式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">帮助文件中位于||之间的内容是超链接，可以用Ctrl+]进入链接，Ctrl+o（Ctrl + t）返回</span><br></pre></td></tr></table></figure><h3 id="其他非编辑命令"><a href="#其他非编辑命令" class="headerlink" title="其他非编辑命令"></a>其他非编辑命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">. 重复前一次命令</span><br><span class="line"></span><br><span class="line">:set ruler?　　查看是否设置了ruler，在.vimrc中，使用set命令设制的选项都可以通过这个命令查看</span><br><span class="line"></span><br><span class="line">:scriptnames　　查看vim脚本文件的位置，比如.vimrc文件，语法文件及plugin等。</span><br><span class="line"></span><br><span class="line">:set list 显示非打印字符，如tab，空格，行尾等。如果tab无法显示，请确定用set lcs&#x3D;tab:&gt;-命令设置了.vimrc文件，并确保你的文件中的确有tab，如果开启了expendtab，那么tab将被扩展为空格。</span><br></pre></td></tr></table></figure><h3 id="Vim教程"><a href="#Vim教程" class="headerlink" title="Vim教程"></a>Vim教程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在Unix系统上</span><br><span class="line"></span><br><span class="line">$ vimtutor</span><br><span class="line"></span><br><span class="line">在Windows系统上</span><br><span class="line">:help tutor</span><br><span class="line"></span><br><span class="line">:syntax 列出已经定义的语法项</span><br><span class="line"></span><br><span class="line">:syntax clear 清除已定义的语法规则</span><br><span class="line"></span><br><span class="line">:syntax case match 大小写敏感，int和Int将视为不同的语法元素</span><br><span class="line"></span><br><span class="line">:syntax case ignore 大小写无关，int和Int将视为相同的语法元素，并使用同样的配色方案</span><br></pre></td></tr></table></figure><h3 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h3><p>[<a href="http://www.cnblogs.com/softwaretesting/archive/2011/07/12/2104435.html" target="_blank" rel="noopener">Vim命令合集</a>]</p>]]></content>
    
    <summary type="html">
    
      Vim命令合集
    
    </summary>
    
    
      <category term="Vim" scheme="https://shuke163.github.io/categories/Vim/"/>
    
    
      <category term="Vim" scheme="https://shuke163.github.io/tags/Vim/"/>
    
  </entry>
  
</feed>
